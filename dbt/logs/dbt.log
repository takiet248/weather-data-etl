[0m22:59:20.370552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bbaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656fc10>]}


============================== 22:59:20.375348 | 29abb6b6-66ad-4c49-907b-7c4f99266705 ==============================
[0m22:59:20.375348 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:59:20.375674 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/tim301248/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:20.376068 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m22:59:20.382036 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05634979, "process_in_blocks": "0", "process_kernel_time": 0.116114, "process_mem_max_rss": "94945280", "process_out_blocks": "0", "process_user_time": 0.703603}
[0m22:59:20.382501 [debug] [MainThread]: Command `dbt run` failed at 22:59:20.382435 after 0.06 seconds
[0m22:59:20.382711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bbaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a08430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106056190>]}
[0m22:59:20.382913 [debug] [MainThread]: Flushing usage events
[0m22:59:21.728637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:43.389042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107450b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082f5400>]}


============================== 22:59:43.391786 | 584365e7-59a1-41bb-85eb-6bde64342ab9 ==============================
[0m22:59:43.391786 [info ] [MainThread]: Running with dbt=1.9.2
[0m22:59:43.392129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/Users/tim301248/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:43.399997 [info ] [MainThread]: dbt version: 1.9.2
[0m22:59:43.400272 [info ] [MainThread]: python version: 3.9.21
[0m22:59:43.400435 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.9/bin/python3.9
[0m22:59:43.400592 [info ] [MainThread]: os info: macOS-13.0.1-arm64-arm-64bit
[0m22:59:43.443671 [info ] [MainThread]: Using profiles dir at /Users/tim301248/.dbt
[0m22:59:43.444019 [info ] [MainThread]: Using profiles.yml file at /Users/tim301248/.dbt/profiles.yml
[0m22:59:43.444207 [info ] [MainThread]: Using dbt_project.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/dbt_project.yml
[0m22:59:43.444548 [info ] [MainThread]: Configuration:
[0m22:59:43.444704 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m22:59:43.444851 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m22:59:43.444992 [info ] [MainThread]: Required dependencies:
[0m22:59:43.445162 [debug] [MainThread]: Executing "git --help"
[0m22:59:43.472922 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:59:43.473690 [debug] [MainThread]: STDERR: "b''"
[0m22:59:43.473889 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:59:43.474066 [info ] [MainThread]: Connection test skipped since no profile was found
[0m22:59:43.474297 [info ] [MainThread]: [31m2 checks failed:[0m
[0m22:59:43.474461 [info ] [MainThread]: Could not load dbt_project.yml
Profile loading failed for the following reason:
Runtime Error
  Credentials in profile "default", target "dev" invalid: 'port' is a required property


[0m22:59:43.474612 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  dbt_project.yml does not parse to a dictionary


[0m22:59:43.476594 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.1226725, "process_in_blocks": "0", "process_kernel_time": 0.115097, "process_mem_max_rss": "95617024", "process_out_blocks": "0", "process_user_time": 0.724845}
[0m22:59:43.477135 [debug] [MainThread]: Command `dbt debug` failed at 22:59:43.477058 after 0.12 seconds
[0m22:59:43.477461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107450b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ae7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828bca0>]}
[0m22:59:43.477768 [debug] [MainThread]: Flushing usage events
[0m22:59:44.664840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:38.522516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108219ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108219430>]}


============================== 23:03:38.525994 | 40324d7d-6d49-4c5f-8a72-bda8ab534fa0 ==============================
[0m23:03:38.525994 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:03:38.526386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m23:03:38.700188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085a80a0>]}
[0m23:03:38.731697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdef40>]}
[0m23:03:38.732667 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:03:38.815791 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:03:38.816229 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:03:38.816430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d7370>]}
[0m23:03:39.355701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108abd130>]}
[0m23:03:39.391510 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:03:39.394432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:03:39.407022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c85b20>]}
[0m23:03:39.407323 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:03:39.407507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a389a0>]}
[0m23:03:39.408248 [info ] [MainThread]: 
[0m23:03:39.408433 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:39.408580 [info ] [MainThread]: 
[0m23:03:39.408856 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:03:39.409327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:03:39.436002 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:03:39.436253 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:03:39.436407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:39.727261 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.291 seconds
[0m23:03:39.730006 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:03:39.731206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now create_weather_db_public_weather_db)
[0m23:03:39.732275 [debug] [ThreadPool]: Creating schema "database: "weather_db"
schema: "public_weather_db"
"
[0m23:03:39.742629 [debug] [ThreadPool]: Using postgres connection "create_weather_db_public_weather_db"
[0m23:03:39.743341 [debug] [ThreadPool]: On create_weather_db_public_weather_db: BEGIN
[0m23:03:39.743779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:39.752096 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m23:03:39.752674 [debug] [ThreadPool]: Using postgres connection "create_weather_db_public_weather_db"
[0m23:03:39.753059 [debug] [ThreadPool]: On create_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "create_weather_db_public_weather_db"} */
create schema if not exists "public_weather_db"
[0m23:03:39.754883 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m23:03:39.756443 [debug] [ThreadPool]: On create_weather_db_public_weather_db: COMMIT
[0m23:03:39.756943 [debug] [ThreadPool]: Using postgres connection "create_weather_db_public_weather_db"
[0m23:03:39.757674 [debug] [ThreadPool]: On create_weather_db_public_weather_db: COMMIT
[0m23:03:39.760492 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m23:03:39.760893 [debug] [ThreadPool]: On create_weather_db_public_weather_db: Close
[0m23:03:39.766679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_weather_db_public_weather_db, now list_weather_db_public_weather_db)
[0m23:03:39.775389 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:03:39.775850 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:03:39.776205 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:03:39.783507 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m23:03:39.784005 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:03:39.784416 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:03:39.789476 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m23:03:39.791159 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:03:39.792028 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:03:39.797830 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:39.798298 [debug] [MainThread]: On master: BEGIN
[0m23:03:39.798601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:39.805160 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:03:39.805607 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:39.806072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:03:39.809830 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:03:39.811126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c85d90>]}
[0m23:03:39.811614 [debug] [MainThread]: On master: ROLLBACK
[0m23:03:39.812328 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:39.812635 [debug] [MainThread]: On master: BEGIN
[0m23:03:39.813692 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:03:39.814059 [debug] [MainThread]: On master: COMMIT
[0m23:03:39.814383 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:39.814677 [debug] [MainThread]: On master: COMMIT
[0m23:03:39.815370 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:39.815737 [debug] [MainThread]: On master: Close
[0m23:03:39.817477 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:03:39.818087 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:03:39.818597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:03:39.818970 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:03:39.828106 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:03:39.828924 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:03:39.861062 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:03:39.861733 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:03:39.861957 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:03:39.862158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:03:39.867732 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m23:03:39.867978 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:03:39.868215 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_weather_db"."staging"
GROUP BY location;
  );
  
[0m23:03:39.868889 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16: GROUP BY location;
                          ^

[0m23:03:39.869106 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:03:39.869702 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:03:39.873873 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 16: GROUP BY location;
                            ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:03:39.875186 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40324d7d-6d49-4c5f-8a72-bda8ab534fa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091c9940>]}
[0m23:03:39.875611 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.06s]
[0m23:03:39.875967 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:03:39.876291 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 16: GROUP BY location;
                            ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:03:39.876960 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:39.877155 [debug] [MainThread]: On master: BEGIN
[0m23:03:39.877318 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:03:39.881692 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:03:39.881917 [debug] [MainThread]: On master: COMMIT
[0m23:03:39.882097 [debug] [MainThread]: Using postgres connection "master"
[0m23:03:39.882259 [debug] [MainThread]: On master: COMMIT
[0m23:03:39.882623 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:03:39.882821 [debug] [MainThread]: On master: Close
[0m23:03:39.883070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:39.883234 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:03:39.883411 [info ] [MainThread]: 
[0m23:03:39.883595 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m23:03:39.884008 [debug] [MainThread]: Command end result
[0m23:03:39.898724 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:03:39.899649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:03:39.903140 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:03:39.903311 [info ] [MainThread]: 
[0m23:03:39.903511 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:03:39.903687 [info ] [MainThread]: 
[0m23:03:39.903877 [error] [MainThread]:   Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 16: GROUP BY location;
                            ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:03:39.904042 [info ] [MainThread]: 
[0m23:03:39.904204 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:03:39.905699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4257978, "process_in_blocks": "0", "process_kernel_time": 0.196304, "process_mem_max_rss": "119521280", "process_out_blocks": "0", "process_user_time": 1.544912}
[0m23:03:39.906084 [debug] [MainThread]: Command `dbt run` failed at 23:03:39.906030 after 1.43 seconds
[0m23:03:39.906307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108921b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c120d0>]}
[0m23:03:39.906519 [debug] [MainThread]: Flushing usage events
[0m23:03:40.948255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:47.846925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e98dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e98400>]}


============================== 23:03:47.850263 | b1d40295-b23c-4213-9f6e-19c60f08cf7a ==============================
[0m23:03:47.850263 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:03:47.850587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m23:03:47.858097 [info ] [MainThread]: dbt version: 1.9.2
[0m23:03:47.858533 [info ] [MainThread]: python version: 3.9.21
[0m23:03:47.858699 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.9/bin/python3.9
[0m23:03:47.858853 [info ] [MainThread]: os info: macOS-13.0.1-arm64-arm-64bit
[0m23:03:47.891841 [info ] [MainThread]: Using profiles dir at /Users/tim301248/Desktop/Data Engineer/weather/dbt
[0m23:03:47.892180 [info ] [MainThread]: Using profiles.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/profiles.yml
[0m23:03:47.892352 [info ] [MainThread]: Using dbt_project.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/dbt_project.yml
[0m23:03:47.892712 [info ] [MainThread]: adapter type: postgres
[0m23:03:47.892925 [info ] [MainThread]: adapter version: 1.9.0
[0m23:03:47.943354 [info ] [MainThread]: Configuration:
[0m23:03:47.943731 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:03:47.943918 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:03:47.944073 [info ] [MainThread]: Required dependencies:
[0m23:03:47.944283 [debug] [MainThread]: Executing "git --help"
[0m23:03:47.969773 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:03:47.970421 [debug] [MainThread]: STDERR: "b''"
[0m23:03:47.970646 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:03:47.970827 [info ] [MainThread]: Connection:
[0m23:03:47.971055 [info ] [MainThread]:   host: localhost
[0m23:03:47.971197 [info ] [MainThread]:   port: 5432
[0m23:03:47.971334 [info ] [MainThread]:   user: airflow
[0m23:03:47.971468 [info ] [MainThread]:   database: weather_db
[0m23:03:47.971601 [info ] [MainThread]:   schema: public
[0m23:03:47.971733 [info ] [MainThread]:   connect_timeout: 10
[0m23:03:47.971866 [info ] [MainThread]:   role: None
[0m23:03:47.971996 [info ] [MainThread]:   search_path: None
[0m23:03:47.972124 [info ] [MainThread]:   keepalives_idle: 0
[0m23:03:47.972254 [info ] [MainThread]:   sslmode: None
[0m23:03:47.972383 [info ] [MainThread]:   sslcert: None
[0m23:03:47.972514 [info ] [MainThread]:   sslkey: None
[0m23:03:47.972643 [info ] [MainThread]:   sslrootcert: None
[0m23:03:47.972772 [info ] [MainThread]:   application_name: dbt
[0m23:03:47.972902 [info ] [MainThread]:   retries: 1
[0m23:03:47.973436 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:03:48.045709 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m23:03:48.064382 [debug] [MainThread]: Using postgres connection "debug"
[0m23:03:48.064629 [debug] [MainThread]: On debug: select 1 as id
[0m23:03:48.064780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:03:48.077855 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m23:03:48.078440 [debug] [MainThread]: On debug: Close
[0m23:03:48.078626 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:03:48.078796 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:03:48.079879 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.26917237, "process_in_blocks": "0", "process_kernel_time": 0.135269, "process_mem_max_rss": "109445120", "process_out_blocks": "0", "process_user_time": 0.817191}
[0m23:03:48.080225 [debug] [MainThread]: Command `dbt debug` succeeded at 23:03:48.080169 after 0.27 seconds
[0m23:03:48.080398 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:03:48.080583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119192d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118287b80>]}
[0m23:03:48.080797 [debug] [MainThread]: Flushing usage events
[0m23:03:49.300346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:05.632176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e15bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e15520>]}


============================== 23:04:05.635035 | e7669ea8-9bc9-41a2-9dfd-00dd415bc793 ==============================
[0m23:04:05.635035 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:04:05.635366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:05.748501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10718bf70>]}
[0m23:04:05.778338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106df7070>]}
[0m23:04:05.779066 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:04:05.858374 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:04:05.918600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:05.918862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:05.935859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107599eb0>]}
[0m23:04:05.972230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:04:05.975162 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:04:05.985899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10755e0d0>]}
[0m23:04:05.986218 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:04:05.986410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b5430>]}
[0m23:04:05.987222 [info ] [MainThread]: 
[0m23:04:05.987415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:05.987571 [info ] [MainThread]: 
[0m23:04:05.987860 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:04:05.988356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:04:06.014044 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:04:06.014294 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:04:06.014446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:06.103208 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.089 seconds
[0m23:04:06.104430 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:04:06.108319 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m23:04:06.113891 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:04:06.114169 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:04:06.114374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:04:06.119551 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:04:06.119783 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:04:06.120015 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:04:06.122580 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:04:06.123552 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:04:06.124093 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:04:06.154851 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:06.155131 [debug] [MainThread]: On master: BEGIN
[0m23:04:06.155282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:06.161115 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m23:04:06.161322 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:06.161558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:04:06.164057 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:04:06.164821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a496d0>]}
[0m23:04:06.165115 [debug] [MainThread]: On master: ROLLBACK
[0m23:04:06.165570 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:06.165743 [debug] [MainThread]: On master: BEGIN
[0m23:04:06.166373 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:04:06.166590 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.166772 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:06.166939 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.167382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:06.167624 [debug] [MainThread]: On master: Close
[0m23:04:06.168508 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:04:06.168843 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:04:06.169134 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:04:06.169351 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:04:06.175602 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:04:06.176159 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:04:06.198449 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:04:06.199012 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:04:06.199202 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:04:06.199370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:04:06.207070 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m23:04:06.207522 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:04:06.207738 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_weather_db"."staging"
GROUP BY location;
  );
  
[0m23:04:06.208246 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 16: GROUP BY location;
                          ^

[0m23:04:06.208503 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:04:06.208938 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:04:06.213239 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 16: GROUP BY location;
                            ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:04:06.214421 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7669ea8-9bc9-41a2-9dfd-00dd415bc793', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6e0d0>]}
[0m23:04:06.214802 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.04s]
[0m23:04:06.215112 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:04:06.215405 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 16: GROUP BY location;
                            ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:04:06.216050 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:06.216233 [debug] [MainThread]: On master: BEGIN
[0m23:04:06.216378 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:04:06.221368 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:04:06.221647 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.221810 [debug] [MainThread]: Using postgres connection "master"
[0m23:04:06.221953 [debug] [MainThread]: On master: COMMIT
[0m23:04:06.222367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:04:06.222597 [debug] [MainThread]: On master: Close
[0m23:04:06.222916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:06.223078 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:04:06.223264 [info ] [MainThread]: 
[0m23:04:06.223458 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m23:04:06.223915 [debug] [MainThread]: Command end result
[0m23:04:06.237251 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:04:06.238256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:04:06.242436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:04:06.242669 [info ] [MainThread]: 
[0m23:04:06.242871 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:04:06.243041 [info ] [MainThread]: 
[0m23:04:06.243239 [error] [MainThread]:   Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 16: GROUP BY location;
                            ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:04:06.243391 [info ] [MainThread]: 
[0m23:04:06.243551 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:04:06.244903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.65601677, "process_in_blocks": "0", "process_kernel_time": 0.17151, "process_mem_max_rss": "115310592", "process_out_blocks": "0", "process_user_time": 1.070777}
[0m23:04:06.245195 [debug] [MainThread]: Command `dbt run` failed at 23:04:06.245150 after 0.66 seconds
[0m23:04:06.245396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e5820>]}
[0m23:04:06.245591 [debug] [MainThread]: Flushing usage events
[0m23:04:07.323072 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:05:04.067061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104441c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044413d0>]}


============================== 23:05:04.069944 | 19f9c2df-bac8-4302-885a-b33cee87718d ==============================
[0m23:05:04.069944 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:05:04.070301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:04.205175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046da2e0>]}
[0m23:05:04.233829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104801940>]}
[0m23:05:04.234488 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:05:04.312493 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:05:04.373658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:05:04.374018 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m23:05:04.494665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d67130>]}
[0m23:05:04.530124 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:05:04.533046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:05:04.567703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439e9d0>]}
[0m23:05:04.567999 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:05:04.568186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103414460>]}
[0m23:05:04.568948 [info ] [MainThread]: 
[0m23:05:04.569136 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:04.569284 [info ] [MainThread]: 
[0m23:05:04.569540 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:05:04.570006 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:05:04.597242 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:05:04.597518 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:05:04.597669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:04.703235 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.105 seconds
[0m23:05:04.704617 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:05:04.708725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m23:05:04.714625 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:05:04.714927 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:05:04.715158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:04.721280 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:05:04.721556 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:05:04.721818 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:05:04.724909 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:05:04.725900 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:05:04.726487 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:05:04.730453 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:04.730766 [debug] [MainThread]: On master: BEGIN
[0m23:05:04.730989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:04.735686 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:05:04.736034 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:04.736397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:05:04.739422 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:05:04.740394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0cf40>]}
[0m23:05:04.740760 [debug] [MainThread]: On master: ROLLBACK
[0m23:05:04.741288 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:04.741517 [debug] [MainThread]: On master: BEGIN
[0m23:05:04.742314 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:05:04.742558 [debug] [MainThread]: On master: COMMIT
[0m23:05:04.742784 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:04.742998 [debug] [MainThread]: On master: COMMIT
[0m23:05:04.743480 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:04.743781 [debug] [MainThread]: On master: Close
[0m23:05:04.745014 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:05:04.745458 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:05:04.745830 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:05:04.746118 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:05:04.754285 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:05:04.755196 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:05:04.780803 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:05:04.781905 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:05:04.782111 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:05:04.782289 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:05:04.785950 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m23:05:04.786245 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:05:04.786454 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_weather_db"."staging"
GROUP BY location
  );
  
[0m23:05:04.787101 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_weather_db.staging" does not exist
LINE 15: FROM "weather_db"."public_weather_db"."staging"
              ^

[0m23:05:04.787361 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:05:04.787862 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:05:04.792073 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 15: FROM "weather_db"."public_weather_db"."staging"
                ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:05:04.793275 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19f9c2df-bac8-4302-885a-b33cee87718d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050afc40>]}
[0m23:05:04.793672 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.05s]
[0m23:05:04.793981 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:05:04.794290 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 15: FROM "weather_db"."public_weather_db"."staging"
                ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:05:04.794940 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:04.795106 [debug] [MainThread]: On master: BEGIN
[0m23:05:04.795245 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:05:04.800296 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:05:04.800599 [debug] [MainThread]: On master: COMMIT
[0m23:05:04.800776 [debug] [MainThread]: Using postgres connection "master"
[0m23:05:04.800929 [debug] [MainThread]: On master: COMMIT
[0m23:05:04.801254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:05:04.801453 [debug] [MainThread]: On master: Close
[0m23:05:04.801715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:04.801871 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:05:04.802039 [info ] [MainThread]: 
[0m23:05:04.802213 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m23:05:04.802598 [debug] [MainThread]: Command end result
[0m23:05:04.816334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:05:04.817330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:05:04.820875 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:05:04.821065 [info ] [MainThread]: 
[0m23:05:04.821275 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:05:04.821446 [info ] [MainThread]: 
[0m23:05:04.821646 [error] [MainThread]:   Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 15: FROM "weather_db"."public_weather_db"."staging"
                ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:05:04.821805 [info ] [MainThread]: 
[0m23:05:04.821970 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:05:04.823644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7962508, "process_in_blocks": "0", "process_kernel_time": 0.198325, "process_mem_max_rss": "118751232", "process_out_blocks": "0", "process_user_time": 1.140751}
[0m23:05:04.824210 [debug] [MainThread]: Command `dbt run` failed at 23:05:04.824143 after 0.80 seconds
[0m23:05:04.824527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb5b50>]}
[0m23:05:04.824738 [debug] [MainThread]: Flushing usage events
[0m23:05:06.101845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:21.491076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abe790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104949dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049492e0>]}


============================== 23:07:21.493995 | b7f90e9a-e5c4-478e-9e45-da876ee888ea ==============================
[0m23:07:21.493995 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:07:21.494339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:07:21.641058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104921820>]}
[0m23:07:21.669465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e3220>]}
[0m23:07:21.670132 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:07:21.749155 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:07:21.808907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:21.809232 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m23:07:21.929886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526e130>]}
[0m23:07:21.965396 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:07:21.968387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:07:22.002623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba5430>]}
[0m23:07:22.002951 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:07:22.003150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a6970>]}
[0m23:07:22.003917 [info ] [MainThread]: 
[0m23:07:22.004111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:22.004257 [info ] [MainThread]: 
[0m23:07:22.004510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:22.004977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:07:22.033933 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:07:22.034185 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:07:22.034334 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:22.128066 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.094 seconds
[0m23:07:22.129144 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:07:22.132789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m23:07:22.137302 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:07:22.137560 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:07:22.137754 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:22.141686 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:07:22.141958 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:07:22.142160 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:07:22.144151 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:07:22.144944 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:07:22.145397 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:07:22.148479 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.148723 [debug] [MainThread]: On master: BEGIN
[0m23:07:22.148885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:22.152676 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:07:22.152958 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.153216 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:22.155147 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:07:22.155882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102be2670>]}
[0m23:07:22.156169 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:22.156592 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.156761 [debug] [MainThread]: On master: BEGIN
[0m23:07:22.157419 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:07:22.157621 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.157783 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.157928 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.158305 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:22.158464 [debug] [MainThread]: On master: Close
[0m23:07:22.159403 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:07:22.159755 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:07:22.160044 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:07:22.160236 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:07:22.166695 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:07:22.167214 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:07:22.189240 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:07:22.189890 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:07:22.190116 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:07:22.190296 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:07:22.194246 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m23:07:22.194517 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:07:22.194705 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    -- SELECT 
--     location, 
--     AVG(avg_temp) AS monthly_avg_temp 
-- FROM "weather_db"."public_weather_db"."staging"
-- GROUP BY location

SELECT * FROM "weather_db"."public_weather_db"."staging" LIMIT 10;
  );
  
[0m23:07:22.195241 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: ... * FROM "weather_db"."public_weather_db"."staging" LIMIT 10;
                                                                       ^

[0m23:07:22.195433 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:07:22.195865 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:07:22.200161 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 18: ... * FROM "weather_db"."public_weather_db"."staging" LIMIT 10;
                                                                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:07:22.201399 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7f90e9a-e5c4-478e-9e45-da876ee888ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b3c40>]}
[0m23:07:22.201800 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.04s]
[0m23:07:22.202117 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:07:22.202394 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 18: ... * FROM "weather_db"."public_weather_db"."staging" LIMIT 10;
                                                                         ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:07:22.203035 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.203203 [debug] [MainThread]: On master: BEGIN
[0m23:07:22.203340 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:22.206927 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:07:22.207283 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.207474 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:22.207636 [debug] [MainThread]: On master: COMMIT
[0m23:07:22.208294 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:22.208577 [debug] [MainThread]: On master: Close
[0m23:07:22.208916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:22.209084 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:07:22.209389 [info ] [MainThread]: 
[0m23:07:22.209618 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m23:07:22.210076 [debug] [MainThread]: Command end result
[0m23:07:22.222907 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:07:22.223928 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:07:22.228391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:07:22.228647 [info ] [MainThread]: 
[0m23:07:22.228867 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:07:22.229044 [info ] [MainThread]: 
[0m23:07:22.229247 [error] [MainThread]:   Database Error in model final (models/final.sql)
  syntax error at or near ";"
  LINE 18: ... * FROM "weather_db"."public_weather_db"."staging" LIMIT 10;
                                                                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:07:22.229409 [info ] [MainThread]: 
[0m23:07:22.229583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:07:22.231318 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7783533, "process_in_blocks": "0", "process_kernel_time": 0.199687, "process_mem_max_rss": "118833152", "process_out_blocks": "0", "process_user_time": 1.133412}
[0m23:07:22.231721 [debug] [MainThread]: Command `dbt run` failed at 23:07:22.231669 after 0.78 seconds
[0m23:07:22.231953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103abe790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050662b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10363e190>]}
[0m23:07:22.232164 [debug] [MainThread]: Flushing usage events
[0m23:07:23.522007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:41.507894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ca730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112359d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123593a0>]}


============================== 23:07:41.511440 | 9b987262-c382-48ef-9402-677d7d7abda0 ==============================
[0m23:07:41.511440 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:07:41.511768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:07:41.616653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072d4f40>]}
[0m23:07:41.645960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a4ca0>]}
[0m23:07:41.646551 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:07:41.725259 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:07:41.783597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:07:41.783934 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m23:07:41.904544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113876130>]}
[0m23:07:41.938345 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:07:41.941124 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:07:41.975459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bfdc0>]}
[0m23:07:41.975769 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:07:41.975952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133bfe50>]}
[0m23:07:41.976630 [info ] [MainThread]: 
[0m23:07:41.976810 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:41.976953 [info ] [MainThread]: 
[0m23:07:41.977210 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:07:41.977686 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:07:42.003795 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:07:42.004054 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:07:42.004205 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:42.108668 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.104 seconds
[0m23:07:42.110081 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:07:42.114486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m23:07:42.120458 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:07:42.120753 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:07:42.120990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:07:42.126901 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m23:07:42.127236 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:07:42.127524 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:07:42.130649 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m23:07:42.131703 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:07:42.132297 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:07:42.136362 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:42.136670 [debug] [MainThread]: On master: BEGIN
[0m23:07:42.136897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:42.141932 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:07:42.142269 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:42.142629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:07:42.145858 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m23:07:42.146860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133aff40>]}
[0m23:07:42.147243 [debug] [MainThread]: On master: ROLLBACK
[0m23:07:42.147798 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:42.148035 [debug] [MainThread]: On master: BEGIN
[0m23:07:42.148864 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:07:42.149101 [debug] [MainThread]: On master: COMMIT
[0m23:07:42.149328 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:42.149547 [debug] [MainThread]: On master: COMMIT
[0m23:07:42.150034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:42.150298 [debug] [MainThread]: On master: Close
[0m23:07:42.152595 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:07:42.153160 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:07:42.153612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:07:42.153940 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:07:42.162128 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:07:42.162787 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:07:42.189294 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:07:42.189907 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:07:42.190137 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:07:42.190334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:07:42.196090 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m23:07:42.196337 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:07:42.196558 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    -- SELECT 
--     location, 
--     AVG(avg_temp) AS monthly_avg_temp 
-- FROM "weather_db"."public_weather_db"."staging"
-- GROUP BY location

SELECT * FROM "weather_db"."public_weather_db"."staging" LIMIT 10
  );
  
[0m23:07:42.197293 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_weather_db.staging" does not exist
LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                       ^

[0m23:07:42.197499 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:07:42.198072 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:07:42.202206 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:07:42.203389 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b987262-c382-48ef-9402-677d7d7abda0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110451f10>]}
[0m23:07:42.203780 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.05s]
[0m23:07:42.204112 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:07:42.204428 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:07:42.205087 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:42.205266 [debug] [MainThread]: On master: BEGIN
[0m23:07:42.205425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:07:42.210617 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:07:42.210949 [debug] [MainThread]: On master: COMMIT
[0m23:07:42.211135 [debug] [MainThread]: Using postgres connection "master"
[0m23:07:42.211300 [debug] [MainThread]: On master: COMMIT
[0m23:07:42.211668 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:07:42.211882 [debug] [MainThread]: On master: Close
[0m23:07:42.212150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:42.212311 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:07:42.212487 [info ] [MainThread]: 
[0m23:07:42.212673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m23:07:42.213076 [debug] [MainThread]: Command end result
[0m23:07:42.226825 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:07:42.228110 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:07:42.231542 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:07:42.231712 [info ] [MainThread]: 
[0m23:07:42.231921 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:07:42.232095 [info ] [MainThread]: 
[0m23:07:42.232292 [error] [MainThread]:   Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:07:42.232449 [info ] [MainThread]: 
[0m23:07:42.232610 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:07:42.234015 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7633724, "process_in_blocks": "0", "process_kernel_time": 0.188238, "process_mem_max_rss": "120225792", "process_out_blocks": "0", "process_user_time": 1.167884}
[0m23:07:42.234308 [debug] [MainThread]: Command `dbt run` failed at 23:07:42.234265 after 0.76 seconds
[0m23:07:42.234502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ca730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110436040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c80280>]}
[0m23:07:42.234691 [debug] [MainThread]: Flushing usage events
[0m23:07:43.362123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:00.203580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11109bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11109b370>]}


============================== 23:09:00.207906 | 93726257-59ac-4ed9-9af8-9de8ac303b28 ==============================
[0m23:09:00.207906 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:09:00.208260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:00.349831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93726257-59ac-4ed9-9af8-9de8ac303b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106921f40>]}
[0m23:09:00.378577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93726257-59ac-4ed9-9af8-9de8ac303b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141d100>]}
[0m23:09:00.379259 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:09:00.458668 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:09:00.519020 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:00.519250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:00.535810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93726257-59ac-4ed9-9af8-9de8ac303b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a54eb0>]}
[0m23:09:00.573193 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:09:00.576039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:09:00.585220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93726257-59ac-4ed9-9af8-9de8ac303b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1a760>]}
[0m23:09:00.585494 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:09:00.585676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93726257-59ac-4ed9-9af8-9de8ac303b28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a226d0>]}
[0m23:09:00.586234 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:09:00.587280 [debug] [MainThread]: Command end result
[0m23:09:00.600243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:09:00.601078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:09:00.602810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:09:00.604201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.44415092, "process_in_blocks": "0", "process_kernel_time": 0.186081, "process_mem_max_rss": "107839488", "process_out_blocks": "0", "process_user_time": 0.95422}
[0m23:09:00.604525 [debug] [MainThread]: Command `dbt run` succeeded at 23:09:00.604476 after 0.44 seconds
[0m23:09:00.604731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a1ad60>]}
[0m23:09:00.604919 [debug] [MainThread]: Flushing usage events
[0m23:09:01.621751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:27.350930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108180c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108180460>]}


============================== 23:10:27.354964 | cfafb428-021b-4047-8c67-6bd3ea1fd088 ==============================
[0m23:10:27.354964 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:10:27.355317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:10:27.489037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106504f40>]}
[0m23:10:27.517768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107486250>]}
[0m23:10:27.518480 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:10:27.598043 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:10:27.637704 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:10:27.638011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c00df0>]}
[0m23:10:28.200329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a12130>]}
[0m23:10:28.237386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:10:28.240735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:10:28.250527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7f310>]}
[0m23:10:28.250838 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:10:28.251028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a7a1c0>]}
[0m23:10:28.251796 [info ] [MainThread]: 
[0m23:10:28.251992 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:28.252142 [info ] [MainThread]: 
[0m23:10:28.252412 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:28.252913 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:10:28.281161 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:10:28.281448 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:10:28.281609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:28.388797 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.107 seconds
[0m23:10:28.389671 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:10:28.392316 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m23:10:28.395891 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:10:28.396109 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:10:28.396262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:28.400130 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m23:10:28.400396 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:10:28.400578 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:10:28.402532 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:10:28.403196 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:10:28.403605 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:10:28.406380 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:28.406620 [debug] [MainThread]: On master: BEGIN
[0m23:10:28.406767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:28.410150 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:10:28.410371 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:28.410590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:28.412295 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m23:10:28.413003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065889d0>]}
[0m23:10:28.413277 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:28.413718 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:28.413920 [debug] [MainThread]: On master: BEGIN
[0m23:10:28.414522 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m23:10:28.414688 [debug] [MainThread]: On master: COMMIT
[0m23:10:28.414844 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:28.414984 [debug] [MainThread]: On master: COMMIT
[0m23:10:28.415382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:28.415536 [debug] [MainThread]: On master: Close
[0m23:10:28.416437 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:10:28.416764 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:10:28.417041 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:10:28.417237 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:10:28.423005 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:10:28.423927 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:10:28.446873 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:10:28.447624 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:10:28.447828 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:10:28.448016 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:10:28.451499 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m23:10:28.451800 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:10:28.452015 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    -- SELECT 
--     location, 
--     AVG(avg_temp) AS monthly_avg_temp 
-- FROM "weather_db"."public_weather_db"."staging"
-- GROUP BY location

SELECT * FROM "weather_db"."public_weather_db"."staging" LIMIT 10
  );
  
[0m23:10:28.452596 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_weather_db.staging" does not exist
LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                       ^

[0m23:10:28.452845 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:10:28.453276 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:10:28.457461 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:10:28.458693 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfafb428-021b-4047-8c67-6bd3ea1fd088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c1a190>]}
[0m23:10:28.459165 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.04s]
[0m23:10:28.459492 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:10:28.459796 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:10:28.460442 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:28.460610 [debug] [MainThread]: On master: BEGIN
[0m23:10:28.460748 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:28.465473 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m23:10:28.465781 [debug] [MainThread]: On master: COMMIT
[0m23:10:28.465949 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:28.466095 [debug] [MainThread]: On master: COMMIT
[0m23:10:28.466430 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:28.466631 [debug] [MainThread]: On master: Close
[0m23:10:28.466882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:28.467034 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:10:28.467200 [info ] [MainThread]: 
[0m23:10:28.467376 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m23:10:28.467763 [debug] [MainThread]: Command end result
[0m23:10:28.480733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:10:28.481755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:10:28.485289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:10:28.485495 [info ] [MainThread]: 
[0m23:10:28.485713 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:10:28.485889 [info ] [MainThread]: 
[0m23:10:28.486100 [error] [MainThread]:   Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:10:28.486267 [info ] [MainThread]: 
[0m23:10:28.486437 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:10:28.488122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.1741724, "process_in_blocks": "0", "process_kernel_time": 0.200508, "process_mem_max_rss": "121896960", "process_out_blocks": "0", "process_user_time": 1.512922}
[0m23:10:28.488516 [debug] [MainThread]: Command `dbt run` failed at 23:10:28.488461 after 1.17 seconds
[0m23:10:28.488745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f6760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074788b0>]}
[0m23:10:28.488963 [debug] [MainThread]: Flushing usage events
[0m23:10:29.724898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:10:41.854316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f5dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f52b0>]}


============================== 23:10:41.858237 | 53a2c0dd-abd8-4042-bdaf-178cf97fbdb2 ==============================
[0m23:10:41.858237 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:10:41.858604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:10:41.966319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848e880>]}
[0m23:10:41.996694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108583760>]}
[0m23:10:41.997477 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:10:42.079892 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:10:42.140964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:10:42.141230 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:10:42.158247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108978eb0>]}
[0m23:10:42.197140 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:10:42.200261 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:10:42.209765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893cf70>]}
[0m23:10:42.210086 [info ] [MainThread]: Found 2 models, 433 macros
[0m23:10:42.210288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10866ab20>]}
[0m23:10:42.211085 [info ] [MainThread]: 
[0m23:10:42.211306 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:42.211462 [info ] [MainThread]: 
[0m23:10:42.211742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:10:42.212272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m23:10:42.240737 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m23:10:42.241036 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m23:10:42.241211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:42.256931 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m23:10:42.257874 [debug] [ThreadPool]: On list_weather_db: Close
[0m23:10:42.261174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m23:10:42.295291 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:10:42.295640 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m23:10:42.295813 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:42.300612 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m23:10:42.300971 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m23:10:42.301169 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m23:10:42.303490 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m23:10:42.304385 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m23:10:42.304935 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m23:10:42.308010 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:42.308330 [debug] [MainThread]: On master: BEGIN
[0m23:10:42.308491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:42.312875 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m23:10:42.313176 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:42.313403 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m23:10:42.315910 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m23:10:42.316676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856a820>]}
[0m23:10:42.316947 [debug] [MainThread]: On master: ROLLBACK
[0m23:10:42.317469 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:42.317632 [debug] [MainThread]: On master: BEGIN
[0m23:10:42.318325 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m23:10:42.318506 [debug] [MainThread]: On master: COMMIT
[0m23:10:42.318658 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:42.318802 [debug] [MainThread]: On master: COMMIT
[0m23:10:42.319197 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:42.319353 [debug] [MainThread]: On master: Close
[0m23:10:42.320145 [debug] [Thread-1  ]: Began running node model.weather_dbt.final
[0m23:10:42.320491 [info ] [Thread-1  ]: 1 of 1 START sql table model public_weather_db.final ........................... [RUN]
[0m23:10:42.320773 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.final)
[0m23:10:42.320981 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.final
[0m23:10:42.326397 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m23:10:42.327225 [debug] [Thread-1  ]: Began executing node model.weather_dbt.final
[0m23:10:42.349317 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m23:10:42.349871 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:10:42.350075 [debug] [Thread-1  ]: On model.weather_dbt.final: BEGIN
[0m23:10:42.350248 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m23:10:42.354386 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m23:10:42.354760 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.final"
[0m23:10:42.354973 [debug] [Thread-1  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    -- SELECT 
--     location, 
--     AVG(avg_temp) AS monthly_avg_temp 
-- FROM "weather_db"."public_weather_db"."staging"
-- GROUP BY location

SELECT * FROM "weather_db"."public_weather_db"."staging" LIMIT 10
  );
  
[0m23:10:42.355654 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public_weather_db.staging" does not exist
LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                       ^

[0m23:10:42.355892 [debug] [Thread-1  ]: On model.weather_dbt.final: ROLLBACK
[0m23:10:42.356382 [debug] [Thread-1  ]: On model.weather_dbt.final: Close
[0m23:10:42.360826 [debug] [Thread-1  ]: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:10:42.362078 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53a2c0dd-abd8-4042-bdaf-178cf97fbdb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724e4c0>]}
[0m23:10:42.362462 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model public_weather_db.final .................. [[31mERROR[0m in 0.04s]
[0m23:10:42.362784 [debug] [Thread-1  ]: Finished running node model.weather_dbt.final
[0m23:10:42.363121 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.final' to be skipped because of status 'error'.  Reason: Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql.
[0m23:10:42.363822 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:42.364001 [debug] [MainThread]: On master: BEGIN
[0m23:10:42.364142 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:10:42.367304 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m23:10:42.367608 [debug] [MainThread]: On master: COMMIT
[0m23:10:42.367791 [debug] [MainThread]: Using postgres connection "master"
[0m23:10:42.367946 [debug] [MainThread]: On master: COMMIT
[0m23:10:42.368322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m23:10:42.368541 [debug] [MainThread]: On master: Close
[0m23:10:42.368806 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:42.368968 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m23:10:42.369145 [info ] [MainThread]: 
[0m23:10:42.369328 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m23:10:42.369712 [debug] [MainThread]: Command end result
[0m23:10:42.383913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:10:42.384930 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:10:42.388444 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m23:10:42.388642 [info ] [MainThread]: 
[0m23:10:42.388864 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:10:42.389032 [info ] [MainThread]: 
[0m23:10:42.389235 [error] [MainThread]:   Database Error in model final (models/final.sql)
  relation "public_weather_db.staging" does not exist
  LINE 18: SELECT * FROM "weather_db"."public_weather_db"."staging" LIM...
                         ^
  compiled code at target/run/weather_dbt/models/final.sql
[0m23:10:42.389395 [info ] [MainThread]: 
[0m23:10:42.389565 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:10:42.390783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5754456, "process_in_blocks": "0", "process_kernel_time": 0.195751, "process_mem_max_rss": "117637120", "process_out_blocks": "0", "process_user_time": 1.070049}
[0m23:10:42.391213 [debug] [MainThread]: Command `dbt run` failed at 23:10:42.391158 after 0.58 seconds
[0m23:10:42.391459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e1f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc75b0>]}
[0m23:10:42.391688 [debug] [MainThread]: Flushing usage events
[0m23:10:43.612019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:08.870549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107632820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111be2340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111be2fa0>]}


============================== 23:11:08.873601 | f52bf926-e56b-40aa-973b-0b6e95d2b097 ==============================
[0m23:11:08.873601 [info ] [MainThread]: Running with dbt=1.9.2
[0m23:11:08.873970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt list', 'send_anonymous_usage_stats': 'True'}
[0m23:11:09.018259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f52bf926-e56b-40aa-973b-0b6e95d2b097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068310d0>]}
[0m23:11:09.048646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f52bf926-e56b-40aa-973b-0b6e95d2b097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111baf8e0>]}
[0m23:11:09.049431 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m23:11:09.132036 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m23:11:09.200245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:11:09.200536 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:11:09.218262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f52bf926-e56b-40aa-973b-0b6e95d2b097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112450130>]}
[0m23:11:09.258799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m23:11:09.262252 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m23:11:09.270270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f52bf926-e56b-40aa-973b-0b6e95d2b097', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112421b20>]}
[0m23:11:09.270751 [info ] [MainThread]: weather_dbt.final
[0m23:11:09.270940 [info ] [MainThread]: weather_dbt.staging
[0m23:11:09.271968 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.4420647, "process_in_blocks": "0", "process_kernel_time": 0.191911, "process_mem_max_rss": "105611264", "process_out_blocks": "0", "process_user_time": 0.980549}
[0m23:11:09.272298 [debug] [MainThread]: Command `dbt list` succeeded at 23:11:09.272236 after 0.44 seconds
[0m23:11:09.272504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107632820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107151d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11222e6d0>]}
[0m23:11:09.272697 [debug] [MainThread]: Flushing usage events
[0m23:11:10.275363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:15:52.210518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058937c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671dbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671d4c0>]}


============================== 11:15:52.213477 | f8aae855-66a3-476d-be2a-4a760d7bb59d ==============================
[0m11:15:52.213477 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:15:52.213828 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:15:52.350060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ebf40>]}
[0m11:15:52.378831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106560e50>]}
[0m11:15:52.379565 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:15:52.458192 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:15:52.518604 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:15:52.518967 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/staging.sql
[0m11:15:52.638902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107048130>]}
[0m11:15:52.674344 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m11:15:52.677119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m11:15:52.712055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106713c70>]}
[0m11:15:52.712392 [info ] [MainThread]: Found 2 models, 433 macros
[0m11:15:52.712587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489ec70>]}
[0m11:15:52.713354 [info ] [MainThread]: 
[0m11:15:52.713557 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:15:52.713715 [info ] [MainThread]: 
[0m11:15:52.713982 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:15:52.716496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m11:15:52.745143 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m11:15:52.745426 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m11:15:52.745589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:15:52.888104 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.142 seconds
[0m11:15:52.889472 [debug] [ThreadPool]: On list_weather_db: Close
[0m11:15:52.890639 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m11:15:52.896800 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m11:15:52.897134 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m11:15:52.897385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:15:52.902495 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m11:15:52.902818 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m11:15:52.903099 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m11:15:52.905984 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m11:15:52.907055 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m11:15:52.907624 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m11:15:52.911587 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:52.911945 [debug] [MainThread]: On master: BEGIN
[0m11:15:52.912203 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:15:52.917318 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m11:15:52.917604 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:52.917952 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:15:52.920956 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m11:15:52.922003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f4bb0>]}
[0m11:15:52.922413 [debug] [MainThread]: On master: ROLLBACK
[0m11:15:52.923023 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:52.923315 [debug] [MainThread]: On master: BEGIN
[0m11:15:52.924179 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:15:52.924434 [debug] [MainThread]: On master: COMMIT
[0m11:15:52.924678 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:52.924908 [debug] [MainThread]: On master: COMMIT
[0m11:15:52.925402 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:52.925690 [debug] [MainThread]: On master: Close
[0m11:15:52.926927 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m11:15:52.927396 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m11:15:52.927797 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m11:15:52.928096 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m11:15:52.935954 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m11:15:52.937417 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m11:15:52.961369 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m11:15:52.961913 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m11:15:52.962123 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m11:15:52.962308 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:15:52.968622 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m11:15:52.968851 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m11:15:52.969053 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    date, location, avg_temp 
FROM weather_data;
  );
  
[0m11:15:52.969891 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: FROM weather_data;
                          ^

[0m11:15:52.970090 [debug] [Thread-1  ]: On model.weather_dbt.staging: ROLLBACK
[0m11:15:52.970749 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m11:15:52.974956 [debug] [Thread-1  ]: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m11:15:52.976080 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8aae855-66a3-476d-be2a-4a760d7bb59d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3d1f0>]}
[0m11:15:52.976459 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public_weather_db.staging ................ [[31mERROR[0m in 0.05s]
[0m11:15:52.976780 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m11:15:52.977101 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql.
[0m11:15:52.977497 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m11:15:52.977774 [info ] [Thread-3  ]: 2 of 2 SKIP relation public_weather_db.final ................................... [[33mSKIP[0m]
[0m11:15:52.978021 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m11:15:52.978600 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:52.978783 [debug] [MainThread]: On master: BEGIN
[0m11:15:52.978937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:15:52.985372 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m11:15:52.985723 [debug] [MainThread]: On master: COMMIT
[0m11:15:52.985930 [debug] [MainThread]: Using postgres connection "master"
[0m11:15:52.986112 [debug] [MainThread]: On master: COMMIT
[0m11:15:52.986724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:15:52.987035 [debug] [MainThread]: On master: Close
[0m11:15:52.987362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:15:52.987544 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m11:15:52.987772 [info ] [MainThread]: 
[0m11:15:52.987972 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:15:52.988413 [debug] [MainThread]: Command end result
[0m11:15:53.012122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m11:15:53.013186 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m11:15:53.017177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m11:15:53.017383 [info ] [MainThread]: 
[0m11:15:53.017610 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:15:53.017798 [info ] [MainThread]: 
[0m11:15:53.018020 [error] [MainThread]:   Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m11:15:53.018198 [info ] [MainThread]: 
[0m11:15:53.018385 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:15:53.021216 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.85178787, "process_in_blocks": "0", "process_kernel_time": 0.219917, "process_mem_max_rss": "116932608", "process_out_blocks": "0", "process_user_time": 1.144536}
[0m11:15:53.021688 [debug] [MainThread]: Command `dbt run` failed at 11:15:53.021633 after 0.85 seconds
[0m11:15:53.021937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058937c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6da00>]}
[0m11:15:53.022170 [debug] [MainThread]: Flushing usage events
[0m11:15:55.235761 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:21:46.129682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e468b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd2490>]}


============================== 12:21:46.133814 | 1327bb55-580b-4bd4-b46c-c20cf1a05669 ==============================
[0m12:21:46.133814 [info ] [MainThread]: Running with dbt=1.9.2
[0m12:21:46.134189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:21:46.268181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc5130>]}
[0m12:21:46.296484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c58df0>]}
[0m12:21:46.297157 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:21:46.375292 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m12:21:46.435125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:46.435366 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:46.451515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744e130>]}
[0m12:21:46.487922 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m12:21:46.491732 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m12:21:46.500989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107418f10>]}
[0m12:21:46.501272 [info ] [MainThread]: Found 2 models, 433 macros
[0m12:21:46.501461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717a730>]}
[0m12:21:46.502228 [info ] [MainThread]: 
[0m12:21:46.502428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:46.502586 [info ] [MainThread]: 
[0m12:21:46.502855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:21:46.505292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m12:21:46.532710 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m12:21:46.532965 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m12:21:46.533130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:46.795045 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.262 seconds
[0m12:21:46.797839 [debug] [ThreadPool]: On list_weather_db: Close
[0m12:21:46.800253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m12:21:46.852482 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m12:21:46.852906 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m12:21:46.853164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:21:46.859873 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:21:46.860234 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m12:21:46.860543 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m12:21:46.864841 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m12:21:46.865901 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m12:21:46.866505 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m12:21:46.870630 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:46.870986 [debug] [MainThread]: On master: BEGIN
[0m12:21:46.871243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:21:46.875703 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:21:46.876037 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:46.876365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:21:46.882762 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m12:21:46.883900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107418c10>]}
[0m12:21:46.884260 [debug] [MainThread]: On master: ROLLBACK
[0m12:21:46.884827 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:46.885075 [debug] [MainThread]: On master: BEGIN
[0m12:21:46.885786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:21:46.886016 [debug] [MainThread]: On master: COMMIT
[0m12:21:46.886222 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:46.886414 [debug] [MainThread]: On master: COMMIT
[0m12:21:46.886815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:21:46.887011 [debug] [MainThread]: On master: Close
[0m12:21:46.888197 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m12:21:46.888584 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m12:21:46.888925 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m12:21:46.889234 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m12:21:46.897038 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m12:21:46.897761 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m12:21:46.921366 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m12:21:46.922138 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m12:21:46.922361 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m12:21:46.922557 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:21:46.930658 [debug] [Thread-1  ]: SQL status: BEGIN in 0.008 seconds
[0m12:21:46.930998 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m12:21:46.931235 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    date, location, avg_temp 
FROM weather_data;
  );
  
[0m12:21:46.931830 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: FROM weather_data;
                          ^

[0m12:21:46.932084 [debug] [Thread-1  ]: On model.weather_dbt.staging: ROLLBACK
[0m12:21:46.932586 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m12:21:46.936944 [debug] [Thread-1  ]: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m12:21:46.938344 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1327bb55-580b-4bd4-b46c-c20cf1a05669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d34d60>]}
[0m12:21:46.938791 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public_weather_db.staging ................ [[31mERROR[0m in 0.05s]
[0m12:21:46.939151 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m12:21:46.939483 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql.
[0m12:21:46.939926 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m12:21:46.940189 [info ] [Thread-3  ]: 2 of 2 SKIP relation public_weather_db.final ................................... [[33mSKIP[0m]
[0m12:21:46.940449 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m12:21:46.941369 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:46.941595 [debug] [MainThread]: On master: BEGIN
[0m12:21:46.941771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:21:46.947387 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:21:46.947672 [debug] [MainThread]: On master: COMMIT
[0m12:21:46.947852 [debug] [MainThread]: Using postgres connection "master"
[0m12:21:46.948012 [debug] [MainThread]: On master: COMMIT
[0m12:21:46.948367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:21:46.948584 [debug] [MainThread]: On master: Close
[0m12:21:46.948853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:21:46.949019 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m12:21:46.949233 [info ] [MainThread]: 
[0m12:21:46.949425 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m12:21:46.949840 [debug] [MainThread]: Command end result
[0m12:21:46.965039 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m12:21:46.966032 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m12:21:46.970054 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m12:21:46.970310 [info ] [MainThread]: 
[0m12:21:46.970539 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:21:46.970731 [info ] [MainThread]: 
[0m12:21:46.970947 [error] [MainThread]:   Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m12:21:46.971118 [info ] [MainThread]: 
[0m12:21:46.971298 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m12:21:46.973071 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.88462794, "process_in_blocks": "0", "process_kernel_time": 0.205814, "process_mem_max_rss": "116736000", "process_out_blocks": "0", "process_user_time": 1.084485}
[0m12:21:46.973522 [debug] [MainThread]: Command `dbt run` failed at 12:21:46.973465 after 0.89 seconds
[0m12:21:46.973765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e468b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e5970>]}
[0m12:21:46.974004 [debug] [MainThread]: Flushing usage events
[0m12:21:52.360318 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:47.579370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608b3a0>]}


============================== 13:11:47.582648 | 0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2 ==============================
[0m13:11:47.582648 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:11:47.583010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:11:47.717865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631a0d0>]}
[0m13:11:47.746254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060670a0>]}
[0m13:11:47.746920 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:11:47.824711 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:11:47.884005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:47.884239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:47.900571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106802130>]}
[0m13:11:47.937145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:11:47.939986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:11:47.949248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cd4f0>]}
[0m13:11:47.949537 [info ] [MainThread]: Found 2 models, 433 macros
[0m13:11:47.949731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d52e0>]}
[0m13:11:47.950511 [info ] [MainThread]: 
[0m13:11:47.950705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:47.950858 [info ] [MainThread]: 
[0m13:11:47.951134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:47.953546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m13:11:47.981762 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m13:11:47.982029 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m13:11:47.982190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:48.150949 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.169 seconds
[0m13:11:48.153024 [debug] [ThreadPool]: On list_weather_db: Close
[0m13:11:48.154535 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m13:11:48.163396 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:11:48.163822 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m13:11:48.164143 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:11:48.171290 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:11:48.171764 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:11:48.172154 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m13:11:48.176015 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:11:48.177565 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m13:11:48.178369 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m13:11:48.220269 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:48.220617 [debug] [MainThread]: On master: BEGIN
[0m13:11:48.220825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:48.226386 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:11:48.226632 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:48.226934 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:11:48.237842 [debug] [MainThread]: SQL status: SELECT 0 in 0.011 seconds
[0m13:11:48.238704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbd3d0>]}
[0m13:11:48.239042 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:48.239551 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:48.239792 [debug] [MainThread]: On master: BEGIN
[0m13:11:48.240585 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:11:48.240873 [debug] [MainThread]: On master: COMMIT
[0m13:11:48.241108 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:48.241324 [debug] [MainThread]: On master: COMMIT
[0m13:11:48.241821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:48.242063 [debug] [MainThread]: On master: Close
[0m13:11:48.243056 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m13:11:48.243461 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m13:11:48.243831 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m13:11:48.244126 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m13:11:48.250383 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m13:11:48.251412 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m13:11:48.275664 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m13:11:48.276288 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:11:48.276528 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m13:11:48.276720 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:11:48.281839 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:11:48.282042 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:11:48.282235 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    date, location, avg_temp 
FROM weather_data;
  );
  
[0m13:11:48.282850 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: FROM weather_data;
                          ^

[0m13:11:48.283054 [debug] [Thread-1  ]: On model.weather_dbt.staging: ROLLBACK
[0m13:11:48.283559 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m13:11:48.287649 [debug] [Thread-1  ]: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m13:11:48.288787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0befd0b0-d8bc-4abb-a5d7-2f3ec763c3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a31f0>]}
[0m13:11:48.289172 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public_weather_db.staging ................ [[31mERROR[0m in 0.04s]
[0m13:11:48.289503 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m13:11:48.289797 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql.
[0m13:11:48.290188 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m13:11:48.290442 [info ] [Thread-3  ]: 2 of 2 SKIP relation public_weather_db.final ................................... [[33mSKIP[0m]
[0m13:11:48.290660 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m13:11:48.291221 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:48.291413 [debug] [MainThread]: On master: BEGIN
[0m13:11:48.291564 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:48.297183 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:11:48.297462 [debug] [MainThread]: On master: COMMIT
[0m13:11:48.297636 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:48.297786 [debug] [MainThread]: On master: COMMIT
[0m13:11:48.298130 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:48.298347 [debug] [MainThread]: On master: Close
[0m13:11:48.298611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:48.298775 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m13:11:48.298990 [info ] [MainThread]: 
[0m13:11:48.299175 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:11:48.299571 [debug] [MainThread]: Command end result
[0m13:11:48.313298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:11:48.314360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:11:48.317964 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m13:11:48.318155 [info ] [MainThread]: 
[0m13:11:48.318359 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:11:48.318536 [info ] [MainThread]: 
[0m13:11:48.318742 [error] [MainThread]:   Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m13:11:48.318905 [info ] [MainThread]: 
[0m13:11:48.319076 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:11:48.320542 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7809586, "process_in_blocks": "0", "process_kernel_time": 0.204326, "process_mem_max_rss": "115441664", "process_out_blocks": "0", "process_user_time": 1.072912}
[0m13:11:48.320907 [debug] [MainThread]: Command `dbt run` failed at 13:11:48.320858 after 0.78 seconds
[0m13:11:48.321126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fb7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053948e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdbbb0>]}
[0m13:11:48.321338 [debug] [MainThread]: Flushing usage events
[0m13:11:51.105324 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:12:54.307823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039da7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10529a3d0>]}


============================== 13:12:54.310622 | a6c3b49f-a305-42fd-b52d-f7eac3660eb3 ==============================
[0m13:12:54.310622 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:12:54.310985 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m13:12:54.319881 [info ] [MainThread]: dbt version: 1.9.2
[0m13:12:54.320177 [info ] [MainThread]: python version: 3.9.21
[0m13:12:54.320344 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.9/bin/python3.9
[0m13:12:54.320506 [info ] [MainThread]: os info: macOS-13.0.1-arm64-arm-64bit
[0m13:12:54.357503 [info ] [MainThread]: Using profiles dir at /Users/tim301248/Desktop/Data Engineer/weather/dbt
[0m13:12:54.357818 [info ] [MainThread]: Using profiles.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/profiles.yml
[0m13:12:54.357995 [info ] [MainThread]: Using dbt_project.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/dbt_project.yml
[0m13:12:54.358313 [info ] [MainThread]: adapter type: postgres
[0m13:12:54.358481 [info ] [MainThread]: adapter version: 1.9.0
[0m13:12:54.410670 [info ] [MainThread]: Configuration:
[0m13:12:54.411105 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:12:54.411283 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:12:54.411473 [info ] [MainThread]: Required dependencies:
[0m13:12:54.411678 [debug] [MainThread]: Executing "git --help"
[0m13:12:54.442304 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:12:54.442962 [debug] [MainThread]: STDERR: "b''"
[0m13:12:54.443206 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:12:54.443417 [info ] [MainThread]: Connection:
[0m13:12:54.443670 [info ] [MainThread]:   host: localhost
[0m13:12:54.443832 [info ] [MainThread]:   port: 5432
[0m13:12:54.443979 [info ] [MainThread]:   user: airflow
[0m13:12:54.444123 [info ] [MainThread]:   database: weather_db
[0m13:12:54.444268 [info ] [MainThread]:   schema: public
[0m13:12:54.444412 [info ] [MainThread]:   connect_timeout: 10
[0m13:12:54.444554 [info ] [MainThread]:   role: None
[0m13:12:54.444692 [info ] [MainThread]:   search_path: None
[0m13:12:54.444834 [info ] [MainThread]:   keepalives_idle: 0
[0m13:12:54.444973 [info ] [MainThread]:   sslmode: None
[0m13:12:54.445167 [info ] [MainThread]:   sslcert: None
[0m13:12:54.445427 [info ] [MainThread]:   sslkey: None
[0m13:12:54.445651 [info ] [MainThread]:   sslrootcert: None
[0m13:12:54.445816 [info ] [MainThread]:   application_name: dbt
[0m13:12:54.445970 [info ] [MainThread]:   retries: 1
[0m13:12:54.446450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:12:54.519900 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:12:54.540398 [debug] [MainThread]: Using postgres connection "debug"
[0m13:12:54.540671 [debug] [MainThread]: On debug: select 1 as id
[0m13:12:54.540840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:12:54.635983 [debug] [MainThread]: SQL status: SELECT 1 in 0.095 seconds
[0m13:12:54.637021 [debug] [MainThread]: On debug: Close
[0m13:12:54.637371 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:12:54.637697 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:12:54.639936 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.36893758, "process_in_blocks": "0", "process_kernel_time": 0.165001, "process_mem_max_rss": "108855296", "process_out_blocks": "0", "process_user_time": 0.795942}
[0m13:12:54.640703 [debug] [MainThread]: Command `dbt debug` succeeded at 13:12:54.640586 after 0.37 seconds
[0m13:12:54.641077 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:12:54.641455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039da7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f9fa0>]}
[0m13:12:54.641892 [debug] [MainThread]: Flushing usage events
[0m13:12:59.929548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:41.298000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a93820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108922d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089223d0>]}


============================== 13:13:41.300938 | 99fca8ba-5206-4a1c-a41e-a906fe7fdf26 ==============================
[0m13:13:41.300938 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:13:41.301323 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:41.311199 [info ] [MainThread]: dbt version: 1.9.2
[0m13:13:41.311515 [info ] [MainThread]: python version: 3.9.21
[0m13:13:41.311689 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.9/bin/python3.9
[0m13:13:41.311852 [info ] [MainThread]: os info: macOS-13.0.1-arm64-arm-64bit
[0m13:13:41.352055 [info ] [MainThread]: Using profiles dir at /Users/tim301248/Desktop/Data Engineer/weather/dbt
[0m13:13:41.352381 [info ] [MainThread]: Using profiles.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/profiles.yml
[0m13:13:41.352564 [info ] [MainThread]: Using dbt_project.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/dbt_project.yml
[0m13:13:41.352925 [info ] [MainThread]: adapter type: postgres
[0m13:13:41.353147 [info ] [MainThread]: adapter version: 1.9.0
[0m13:13:41.403671 [info ] [MainThread]: Configuration:
[0m13:13:41.404002 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:13:41.404173 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:13:41.404331 [info ] [MainThread]: Required dependencies:
[0m13:13:41.404534 [debug] [MainThread]: Executing "git --help"
[0m13:13:41.432505 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:13:41.433151 [debug] [MainThread]: STDERR: "b''"
[0m13:13:41.433358 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:13:41.433547 [info ] [MainThread]: Connection:
[0m13:13:41.433769 [info ] [MainThread]:   host: localhost
[0m13:13:41.433924 [info ] [MainThread]:   port: 5432
[0m13:13:41.434074 [info ] [MainThread]:   user: airflow
[0m13:13:41.434221 [info ] [MainThread]:   database: weather_db
[0m13:13:41.434363 [info ] [MainThread]:   schema: public
[0m13:13:41.434507 [info ] [MainThread]:   connect_timeout: 10
[0m13:13:41.434651 [info ] [MainThread]:   role: None
[0m13:13:41.434790 [info ] [MainThread]:   search_path: None
[0m13:13:41.434933 [info ] [MainThread]:   keepalives_idle: 0
[0m13:13:41.435074 [info ] [MainThread]:   sslmode: None
[0m13:13:41.435223 [info ] [MainThread]:   sslcert: None
[0m13:13:41.435365 [info ] [MainThread]:   sslkey: None
[0m13:13:41.435502 [info ] [MainThread]:   sslrootcert: None
[0m13:13:41.435639 [info ] [MainThread]:   application_name: dbt
[0m13:13:41.435777 [info ] [MainThread]:   retries: 1
[0m13:13:41.436180 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:13:41.509323 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:13:41.530102 [debug] [MainThread]: Using postgres connection "debug"
[0m13:13:41.530343 [debug] [MainThread]: On debug: select 1 as id
[0m13:13:41.530497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:41.626799 [debug] [MainThread]: SQL status: SELECT 1 in 0.096 seconds
[0m13:13:41.627876 [debug] [MainThread]: On debug: Close
[0m13:13:41.628224 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:13:41.628543 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:13:41.630841 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3708065, "process_in_blocks": "0", "process_kernel_time": 0.172044, "process_mem_max_rss": "109723648", "process_out_blocks": "0", "process_user_time": 0.788257}
[0m13:13:41.631598 [debug] [MainThread]: Command `dbt debug` succeeded at 13:13:41.631482 after 0.37 seconds
[0m13:13:41.631971 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:13:41.632329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a93820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108922670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d117c0>]}
[0m13:13:41.632738 [debug] [MainThread]: Flushing usage events
[0m13:13:47.227769 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:51.142546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9f520>]}


============================== 13:13:51.145592 | ae1a8b41-8e63-40d1-a3b4-4c2376215731 ==============================
[0m13:13:51.145592 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:13:51.145952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:13:51.280985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de0f10>]}
[0m13:13:51.312613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051c22b0>]}
[0m13:13:51.313448 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:13:51.393529 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:13:51.456242 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:51.456663 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m13:13:51.587640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b7130>]}
[0m13:13:51.628639 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:13:51.632000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:13:51.670895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c44f40>]}
[0m13:13:51.671231 [info ] [MainThread]: Found 2 models, 433 macros
[0m13:13:51.671435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bcef40>]}
[0m13:13:51.672262 [info ] [MainThread]: 
[0m13:13:51.672467 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:51.672626 [info ] [MainThread]: 
[0m13:13:51.672910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:13:51.675406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m13:13:51.702841 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m13:13:51.703134 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m13:13:51.703306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:51.716576 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.013 seconds
[0m13:13:51.717458 [debug] [ThreadPool]: On list_weather_db: Close
[0m13:13:51.718214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m13:13:51.722013 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:13:51.722278 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m13:13:51.722438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:51.726515 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m13:13:51.726898 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:13:51.727101 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m13:13:51.729727 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m13:13:51.730515 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m13:13:51.731016 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m13:13:51.733838 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:51.734112 [debug] [MainThread]: On master: BEGIN
[0m13:13:51.734272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:51.738038 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:13:51.738367 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:51.738612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:13:51.742567 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m13:13:51.743367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057d9e20>]}
[0m13:13:51.743649 [debug] [MainThread]: On master: ROLLBACK
[0m13:13:51.744146 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:51.744354 [debug] [MainThread]: On master: BEGIN
[0m13:13:51.744992 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:13:51.745187 [debug] [MainThread]: On master: COMMIT
[0m13:13:51.745352 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:51.745503 [debug] [MainThread]: On master: COMMIT
[0m13:13:51.745919 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:13:51.746123 [debug] [MainThread]: On master: Close
[0m13:13:51.747555 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m13:13:51.747962 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m13:13:51.748266 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m13:13:51.748481 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m13:13:51.753538 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m13:13:51.754410 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m13:13:51.777052 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m13:13:51.777724 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:13:51.777931 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m13:13:51.778115 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:51.781618 [debug] [Thread-1  ]: SQL status: BEGIN in 0.003 seconds
[0m13:13:51.781929 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:13:51.782146 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    date, location, avg_temp 
FROM weather_data;
  );
  
[0m13:13:51.782684 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: FROM weather_data;
                          ^

[0m13:13:51.782889 [debug] [Thread-1  ]: On model.weather_dbt.staging: ROLLBACK
[0m13:13:51.783319 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m13:13:51.787549 [debug] [Thread-1  ]: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m13:13:51.788764 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae1a8b41-8e63-40d1-a3b4-4c2376215731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407bd30>]}
[0m13:13:51.789188 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public_weather_db.staging ................ [[31mERROR[0m in 0.04s]
[0m13:13:51.789520 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m13:13:51.789821 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql.
[0m13:13:51.790214 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m13:13:51.790481 [info ] [Thread-3  ]: 2 of 2 SKIP relation public_weather_db.final ................................... [[33mSKIP[0m]
[0m13:13:51.790716 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m13:13:51.791443 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:51.791658 [debug] [MainThread]: On master: BEGIN
[0m13:13:51.791815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:51.795834 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:13:51.796113 [debug] [MainThread]: On master: COMMIT
[0m13:13:51.796289 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:51.796439 [debug] [MainThread]: On master: COMMIT
[0m13:13:51.796802 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:13:51.797021 [debug] [MainThread]: On master: Close
[0m13:13:51.797289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:51.797452 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m13:13:51.797665 [info ] [MainThread]: 
[0m13:13:51.797856 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m13:13:51.798258 [debug] [MainThread]: Command end result
[0m13:13:51.814411 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:13:51.815494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:13:51.819594 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m13:13:51.819911 [info ] [MainThread]: 
[0m13:13:51.820149 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:13:51.820341 [info ] [MainThread]: 
[0m13:13:51.820562 [error] [MainThread]:   Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 14: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m13:13:51.820735 [info ] [MainThread]: 
[0m13:13:51.820915 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:13:51.822202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7185145, "process_in_blocks": "0", "process_kernel_time": 0.190395, "process_mem_max_rss": "120586240", "process_out_blocks": "0", "process_user_time": 1.191129}
[0m13:13:51.822661 [debug] [MainThread]: Command `dbt run` failed at 13:13:51.822605 after 0.72 seconds
[0m13:13:51.822910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106004c40>]}
[0m13:13:51.823167 [debug] [MainThread]: Flushing usage events
[0m13:13:52.999684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:30.910899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afe880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698b640>]}


============================== 13:15:30.914454 | 6e5c846b-db46-45d2-838e-414b36eba624 ==============================
[0m13:15:30.914454 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:15:30.914807 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:31.049990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cfd7f0>]}
[0m13:15:31.078337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c016a0>]}
[0m13:15:31.079011 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:15:31.157332 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:15:31.220859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:15:31.221221 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/staging.sql
[0m13:15:31.221438 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m13:15:31.344963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b4130>]}
[0m13:15:31.380779 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:15:31.383936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:15:31.420360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e5bb0>]}
[0m13:15:31.420675 [info ] [MainThread]: Found 2 models, 433 macros
[0m13:15:31.420867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e80a0>]}
[0m13:15:31.421560 [info ] [MainThread]: 
[0m13:15:31.421755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:31.421910 [info ] [MainThread]: 
[0m13:15:31.422170 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:15:31.424530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m13:15:31.451235 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m13:15:31.451486 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m13:15:31.451647 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:31.553978 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.102 seconds
[0m13:15:31.555325 [debug] [ThreadPool]: On list_weather_db: Close
[0m13:15:31.556521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m13:15:31.563199 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:15:31.563590 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m13:15:31.563876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:31.569203 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:15:31.569545 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:15:31.569869 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m13:15:31.573407 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m13:15:31.574509 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m13:15:31.575127 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m13:15:31.579599 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:31.579951 [debug] [MainThread]: On master: BEGIN
[0m13:15:31.580208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:31.584876 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:15:31.585235 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:31.585615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:15:31.590958 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m13:15:31.591969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d17e50>]}
[0m13:15:31.592369 [debug] [MainThread]: On master: ROLLBACK
[0m13:15:31.592939 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:31.593186 [debug] [MainThread]: On master: BEGIN
[0m13:15:31.594083 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:15:31.594389 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.594651 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:31.594929 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.595493 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:15:31.595845 [debug] [MainThread]: On master: Close
[0m13:15:31.597344 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m13:15:31.597896 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m13:15:31.598362 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m13:15:31.598689 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m13:15:31.605872 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m13:15:31.607631 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m13:15:31.634387 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m13:15:31.634992 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:31.635218 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m13:15:31.635424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:15:31.640970 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:15:31.641228 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:31.641450 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data;
  );
  
[0m13:15:31.642347 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 13: FROM weather_data;
                          ^

[0m13:15:31.642560 [debug] [Thread-1  ]: On model.weather_dbt.staging: ROLLBACK
[0m13:15:31.643144 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m13:15:31.647279 [debug] [Thread-1  ]: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 13: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m13:15:31.648451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6e5c846b-db46-45d2-838e-414b36eba624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107602c10>]}
[0m13:15:31.648862 [error] [Thread-1  ]: 1 of 2 ERROR creating sql table model public_weather_db.staging ................ [[31mERROR[0m in 0.05s]
[0m13:15:31.649204 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m13:15:31.649527 [debug] [Thread-7  ]: Marking all children of 'model.weather_dbt.staging' to be skipped because of status 'error'.  Reason: Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 13: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql.
[0m13:15:31.649930 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m13:15:31.650213 [info ] [Thread-3  ]: 2 of 2 SKIP relation public_weather_db.final ................................... [[33mSKIP[0m]
[0m13:15:31.650448 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m13:15:31.651085 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:31.651306 [debug] [MainThread]: On master: BEGIN
[0m13:15:31.651478 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:31.661708 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:15:31.662061 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.662259 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:31.662435 [debug] [MainThread]: On master: COMMIT
[0m13:15:31.663518 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:15:31.663763 [debug] [MainThread]: On master: Close
[0m13:15:31.664066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:31.664246 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m13:15:31.664481 [info ] [MainThread]: 
[0m13:15:31.664697 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:15:31.665181 [debug] [MainThread]: Command end result
[0m13:15:31.681140 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:15:31.682153 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:15:31.685812 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m13:15:31.686003 [info ] [MainThread]: 
[0m13:15:31.686208 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:31.686382 [info ] [MainThread]: 
[0m13:15:31.686593 [error] [MainThread]:   Database Error in model staging (models/staging.sql)
  syntax error at or near ";"
  LINE 13: FROM weather_data;
                            ^
  compiled code at target/run/weather_dbt/models/staging.sql
[0m13:15:31.686760 [info ] [MainThread]: 
[0m13:15:31.686934 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m13:15:31.688038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8143135, "process_in_blocks": "0", "process_kernel_time": 0.195413, "process_mem_max_rss": "119504896", "process_out_blocks": "0", "process_user_time": 1.144228}
[0m13:15:31.688364 [debug] [MainThread]: Command `dbt run` failed at 13:15:31.688318 after 0.81 seconds
[0m13:15:31.688588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105afe880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db8820>]}
[0m13:15:31.688798 [debug] [MainThread]: Flushing usage events
[0m13:15:32.956643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:52.585187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547e880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310ac0>]}


============================== 13:15:52.587952 | 14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e ==============================
[0m13:15:52.587952 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:15:52.588282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:52.689853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106694220>]}
[0m13:15:52.718102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e0130>]}
[0m13:15:52.718965 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:15:52.796723 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:15:52.855659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:15:52.856024 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m13:15:52.856244 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/staging.sql
[0m13:15:52.978872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c32130>]}
[0m13:15:53.014081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:15:53.016964 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:15:53.051234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6b910>]}
[0m13:15:53.051567 [info ] [MainThread]: Found 2 models, 433 macros
[0m13:15:53.051761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6b970>]}
[0m13:15:53.052489 [info ] [MainThread]: 
[0m13:15:53.052681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:15:53.052836 [info ] [MainThread]: 
[0m13:15:53.053101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:15:53.055583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m13:15:53.081215 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m13:15:53.081475 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m13:15:53.081635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:53.188924 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.107 seconds
[0m13:15:53.190442 [debug] [ThreadPool]: On list_weather_db: Close
[0m13:15:53.191615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m13:15:53.197883 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:15:53.198245 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m13:15:53.198525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:53.204840 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m13:15:53.205205 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:15:53.205528 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m13:15:53.209470 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m13:15:53.210592 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m13:15:53.211192 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m13:15:53.215662 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:53.216017 [debug] [MainThread]: On master: BEGIN
[0m13:15:53.216292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:15:53.220875 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:15:53.221209 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:53.221582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:15:53.228428 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:15:53.229631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106678fa0>]}
[0m13:15:53.230081 [debug] [MainThread]: On master: ROLLBACK
[0m13:15:53.230721 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:53.231009 [debug] [MainThread]: On master: BEGIN
[0m13:15:53.231982 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:15:53.232302 [debug] [MainThread]: On master: COMMIT
[0m13:15:53.232588 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:53.232860 [debug] [MainThread]: On master: COMMIT
[0m13:15:53.233427 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:15:53.233747 [debug] [MainThread]: On master: Close
[0m13:15:53.235904 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m13:15:53.236419 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m13:15:53.236813 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m13:15:53.237120 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m13:15:53.244234 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m13:15:53.244880 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m13:15:53.271889 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m13:15:53.272462 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:53.272690 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m13:15:53.272896 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:15:53.279354 [debug] [Thread-1  ]: SQL status: BEGIN in 0.006 seconds
[0m13:15:53.279607 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:53.279831 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data
  );
  
[0m13:15:53.761524 [debug] [Thread-1  ]: SQL status: SELECT 995879 in 0.481 seconds
[0m13:15:53.773327 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:53.774113 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging__dbt_tmp" rename to "staging"
[0m13:15:53.775774 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:53.794388 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m13:15:53.794941 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:53.795394 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m13:15:53.800219 [debug] [Thread-1  ]: SQL status: COMMIT in 0.004 seconds
[0m13:15:53.804913 [debug] [Thread-1  ]: Applying DROP to: "weather_db"."public_weather_db"."staging__dbt_backup"
[0m13:15:53.808956 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:15:53.809392 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
drop table if exists "weather_db"."public_weather_db"."staging__dbt_backup" cascade
[0m13:15:53.810683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.001 seconds
[0m13:15:53.812614 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m13:15:53.814065 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee22e0>]}
[0m13:15:53.814583 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_weather_db.staging .................... [[32mSELECT 995879[0m in 0.58s]
[0m13:15:53.815026 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m13:15:53.815550 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m13:15:53.816040 [info ] [Thread-3  ]: 2 of 2 START sql table model public_weather_db.final ........................... [RUN]
[0m13:15:53.816455 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.weather_dbt.final'
[0m13:15:53.816812 [debug] [Thread-3  ]: Began compiling node model.weather_dbt.final
[0m13:15:53.820700 [debug] [Thread-3  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m13:15:53.821367 [debug] [Thread-3  ]: Began executing node model.weather_dbt.final
[0m13:15:53.824717 [debug] [Thread-3  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m13:15:53.825332 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:15:53.825615 [debug] [Thread-3  ]: On model.weather_dbt.final: BEGIN
[0m13:15:53.825866 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:15:53.830237 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m13:15:53.830569 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:15:53.830850 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    -- SELECT 
--     location, 
--     AVG(avg_temp) AS monthly_avg_temp 
-- FROM "weather_db"."public_weather_db"."staging"
-- GROUP BY location;

SELECT *
FROM "weather_db"."public_weather_db"."staging"
  );
  
[0m13:15:54.487778 [debug] [Thread-3  ]: SQL status: SELECT 995879 in 0.656 seconds
[0m13:15:54.494636 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:15:54.495273 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final__dbt_tmp" rename to "final"
[0m13:15:54.496398 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:54.497509 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m13:15:54.497745 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:15:54.497941 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m13:15:54.503375 [debug] [Thread-3  ]: SQL status: COMMIT in 0.005 seconds
[0m13:15:54.505401 [debug] [Thread-3  ]: Applying DROP to: "weather_db"."public_weather_db"."final__dbt_backup"
[0m13:15:54.505864 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:15:54.506067 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
drop table if exists "weather_db"."public_weather_db"."final__dbt_backup" cascade
[0m13:15:54.506657 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.000 seconds
[0m13:15:54.507460 [debug] [Thread-3  ]: On model.weather_dbt.final: Close
[0m13:15:54.507824 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14f85e9d-5ef3-41d1-9f00-0a18e6e6db5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704da30>]}
[0m13:15:54.508222 [info ] [Thread-3  ]: 2 of 2 OK created sql table model public_weather_db.final ...................... [[32mSELECT 995879[0m in 0.69s]
[0m13:15:54.508556 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m13:15:54.509489 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:54.509754 [debug] [MainThread]: On master: BEGIN
[0m13:15:54.509937 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:54.514904 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m13:15:54.515233 [debug] [MainThread]: On master: COMMIT
[0m13:15:54.515416 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:54.515576 [debug] [MainThread]: On master: COMMIT
[0m13:15:54.515995 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:15:54.516216 [debug] [MainThread]: On master: Close
[0m13:15:54.516484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:54.516653 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m13:15:54.516805 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m13:15:54.517020 [info ] [MainThread]: 
[0m13:15:54.517216 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m13:15:54.517683 [debug] [MainThread]: Command end result
[0m13:15:54.532140 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:15:54.533114 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:15:54.536866 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m13:15:54.537073 [info ] [MainThread]: 
[0m13:15:54.537308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:54.537483 [info ] [MainThread]: 
[0m13:15:54.537669 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:15:54.539483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9906495, "process_in_blocks": "0", "process_kernel_time": 0.192924, "process_mem_max_rss": "119013376", "process_out_blocks": "0", "process_user_time": 1.218298}
[0m13:15:54.540034 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:54.539970 after 1.99 seconds
[0m13:15:54.540292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10547e880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78d60>]}
[0m13:15:54.540552 [debug] [MainThread]: Flushing usage events
[0m13:15:55.875283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:24.313818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669adc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10669a250>]}


============================== 13:16:24.317233 | 2cf58b94-6825-4a03-831c-0e170696d7d5 ==============================
[0m13:16:24.317233 [info ] [MainThread]: Running with dbt=1.9.2
[0m13:16:24.317629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:24.465096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c69a0>]}
[0m13:16:24.495415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106653850>]}
[0m13:16:24.496164 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:16:24.577846 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m13:16:24.644176 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:24.644640 [debug] [MainThread]: Partial parsing: updated file: weather_dbt://models/final.sql
[0m13:16:24.777944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079b6130>]}
[0m13:16:24.818122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:16:24.821282 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:16:24.856201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668fe20>]}
[0m13:16:24.856523 [info ] [MainThread]: Found 2 models, 433 macros
[0m13:16:24.856721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c1ee0>]}
[0m13:16:24.857507 [info ] [MainThread]: 
[0m13:16:24.857712 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:16:24.857873 [info ] [MainThread]: 
[0m13:16:24.858206 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:16:24.860652 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m13:16:24.886606 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m13:16:24.886860 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m13:16:24.887019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:25.005074 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.118 seconds
[0m13:16:25.006551 [debug] [ThreadPool]: On list_weather_db: Close
[0m13:16:25.008460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m13:16:25.015291 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:16:25.015672 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m13:16:25.015954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:25.021482 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m13:16:25.021887 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m13:16:25.022224 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m13:16:25.025816 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m13:16:25.027131 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m13:16:25.027824 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m13:16:25.032796 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:25.033169 [debug] [MainThread]: On master: BEGIN
[0m13:16:25.033442 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:25.039590 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m13:16:25.039898 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:25.040289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:16:25.050186 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m13:16:25.051453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c33af0>]}
[0m13:16:25.051921 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:25.052594 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:25.052956 [debug] [MainThread]: On master: BEGIN
[0m13:16:25.053863 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:16:25.054151 [debug] [MainThread]: On master: COMMIT
[0m13:16:25.054425 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:25.054680 [debug] [MainThread]: On master: COMMIT
[0m13:16:25.055210 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:25.055542 [debug] [MainThread]: On master: Close
[0m13:16:25.056913 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m13:16:25.057439 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m13:16:25.057916 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m13:16:25.058273 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m13:16:25.066390 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m13:16:25.067401 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m13:16:25.092832 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m13:16:25.093358 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:16:25.093585 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m13:16:25.093781 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:25.099164 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m13:16:25.099422 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:16:25.099642 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data
  );
  
[0m13:16:25.738283 [debug] [Thread-1  ]: SQL status: SELECT 995879 in 0.638 seconds
[0m13:16:25.752578 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:16:25.753360 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging" rename to "staging__dbt_backup"
[0m13:16:25.754516 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:25.756915 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:16:25.757177 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging__dbt_tmp" rename to "staging"
[0m13:16:25.757845 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:25.774330 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m13:16:25.774715 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:16:25.774947 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m13:16:25.776049 [debug] [Thread-1  ]: SQL status: COMMIT in 0.001 seconds
[0m13:16:25.780659 [debug] [Thread-1  ]: Applying DROP to: "weather_db"."public_weather_db"."staging__dbt_backup"
[0m13:16:25.784407 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m13:16:25.784863 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
drop table if exists "weather_db"."public_weather_db"."staging__dbt_backup" cascade
[0m13:16:25.792103 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m13:16:25.793943 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m13:16:25.795398 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f99d0>]}
[0m13:16:25.795876 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_weather_db.staging .................... [[32mSELECT 995879[0m in 0.74s]
[0m13:16:25.796273 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m13:16:25.796873 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m13:16:25.797251 [info ] [Thread-3  ]: 2 of 2 START sql table model public_weather_db.final ........................... [RUN]
[0m13:16:25.797599 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.weather_dbt.final'
[0m13:16:25.797817 [debug] [Thread-3  ]: Began compiling node model.weather_dbt.final
[0m13:16:25.800973 [debug] [Thread-3  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m13:16:25.801603 [debug] [Thread-3  ]: Began executing node model.weather_dbt.final
[0m13:16:25.804503 [debug] [Thread-3  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m13:16:25.804973 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:16:25.805218 [debug] [Thread-3  ]: On model.weather_dbt.final: BEGIN
[0m13:16:25.805436 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:16:25.810211 [debug] [Thread-3  ]: SQL status: BEGIN in 0.005 seconds
[0m13:16:25.810530 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:16:25.810778 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_weather_db"."staging"
GROUP BY location
  );
  
[0m13:16:25.866322 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.055 seconds
[0m13:16:25.868503 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:16:25.868731 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final" rename to "final__dbt_backup"
[0m13:16:25.869297 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:25.871165 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:16:25.871391 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final__dbt_tmp" rename to "final"
[0m13:16:25.871922 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:25.872929 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m13:16:25.873155 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:16:25.873360 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m13:16:25.874083 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m13:16:25.875761 [debug] [Thread-3  ]: Applying DROP to: "weather_db"."public_weather_db"."final__dbt_backup"
[0m13:16:25.876203 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m13:16:25.876414 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
drop table if exists "weather_db"."public_weather_db"."final__dbt_backup" cascade
[0m13:16:25.881682 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.005 seconds
[0m13:16:25.882535 [debug] [Thread-3  ]: On model.weather_dbt.final: Close
[0m13:16:25.882907 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cf58b94-6825-4a03-831c-0e170696d7d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c0130>]}
[0m13:16:25.883311 [info ] [Thread-3  ]: 2 of 2 OK created sql table model public_weather_db.final ...................... [[32mSELECT 10[0m in 0.09s]
[0m13:16:25.883646 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m13:16:25.884388 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:25.884582 [debug] [MainThread]: On master: BEGIN
[0m13:16:25.884742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:25.893285 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:16:25.893618 [debug] [MainThread]: On master: COMMIT
[0m13:16:25.893818 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:25.893997 [debug] [MainThread]: On master: COMMIT
[0m13:16:25.894432 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:25.894663 [debug] [MainThread]: On master: Close
[0m13:16:25.894949 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:25.895123 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m13:16:25.895281 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m13:16:25.895510 [info ] [MainThread]: 
[0m13:16:25.895710 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m13:16:25.896219 [debug] [MainThread]: Command end result
[0m13:16:25.912735 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m13:16:25.913871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m13:16:25.918350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m13:16:25.918587 [info ] [MainThread]: 
[0m13:16:25.918861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:25.919070 [info ] [MainThread]: 
[0m13:16:25.919289 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:16:25.921070 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6481903, "process_in_blocks": "0", "process_kernel_time": 0.210307, "process_mem_max_rss": "120160256", "process_out_blocks": "0", "process_user_time": 1.260354}
[0m13:16:25.921576 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:25.921511 after 1.65 seconds
[0m13:16:25.921880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105152070>]}
[0m13:16:25.922171 [debug] [MainThread]: Flushing usage events
[0m13:16:27.186993 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:05.216262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e03880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c928e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c92550>]}


============================== 14:41:05.220435 | 4ca6c2de-17a6-4b28-b513-c82c29069387 ==============================
[0m14:41:05.220435 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:41:05.220869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:05.358592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107018220>]}
[0m14:41:05.386905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c63130>]}
[0m14:41:05.387613 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:41:05.465696 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:41:05.525505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:05.525753 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:05.542209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10740b130>]}
[0m14:41:05.578667 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m14:41:05.581859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m14:41:05.592420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d49a0>]}
[0m14:41:05.592724 [info ] [MainThread]: Found 2 models, 433 macros
[0m14:41:05.592926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107136610>]}
[0m14:41:05.593705 [info ] [MainThread]: 
[0m14:41:05.593907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:05.594064 [info ] [MainThread]: 
[0m14:41:05.594340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:05.596771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m14:41:05.623618 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m14:41:05.623859 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m14:41:05.624018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:05.726319 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.102 seconds
[0m14:41:05.727671 [debug] [ThreadPool]: On list_weather_db: Close
[0m14:41:05.728790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m14:41:05.735687 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m14:41:05.736086 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m14:41:05.736367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:05.741617 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:41:05.741986 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m14:41:05.742332 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m14:41:05.746598 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m14:41:05.747847 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m14:41:05.748472 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m14:41:05.782151 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.782466 [debug] [MainThread]: On master: BEGIN
[0m14:41:05.782662 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:05.789247 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:41:05.789474 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.789744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:05.798915 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m14:41:05.799744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078c5640>]}
[0m14:41:05.800071 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:05.800732 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.800958 [debug] [MainThread]: On master: BEGIN
[0m14:41:05.801727 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:41:05.801942 [debug] [MainThread]: On master: COMMIT
[0m14:41:05.802148 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.802343 [debug] [MainThread]: On master: COMMIT
[0m14:41:05.804496 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:41:05.804780 [debug] [MainThread]: On master: Close
[0m14:41:05.806089 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m14:41:05.806524 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m14:41:05.806882 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m14:41:05.807155 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m14:41:05.812947 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m14:41:05.813771 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m14:41:05.837188 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m14:41:05.837708 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m14:41:05.837921 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m14:41:05.838109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:41:05.843453 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m14:41:05.843669 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m14:41:05.843875 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data
  );
  
[0m14:41:06.483144 [debug] [Thread-1  ]: SQL status: SELECT 995879 in 0.639 seconds
[0m14:41:06.487297 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m14:41:06.487541 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging" rename to "staging__dbt_backup"
[0m14:41:06.488723 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:06.490661 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m14:41:06.490885 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging__dbt_tmp" rename to "staging"
[0m14:41:06.491431 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:06.508822 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m14:41:06.509190 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m14:41:06.509484 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m14:41:06.518350 [debug] [Thread-1  ]: SQL status: COMMIT in 0.009 seconds
[0m14:41:06.522822 [debug] [Thread-1  ]: Applying DROP to: "weather_db"."public_weather_db"."staging__dbt_backup"
[0m14:41:06.525988 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m14:41:06.526270 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
drop table if exists "weather_db"."public_weather_db"."staging__dbt_backup" cascade
[0m14:41:06.534189 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.008 seconds
[0m14:41:06.535905 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m14:41:06.537246 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107032520>]}
[0m14:41:06.537757 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_weather_db.staging .................... [[32mSELECT 995879[0m in 0.73s]
[0m14:41:06.538161 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m14:41:06.538659 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m14:41:06.538995 [info ] [Thread-3  ]: 2 of 2 START sql table model public_weather_db.final ........................... [RUN]
[0m14:41:06.539358 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.weather_dbt.final'
[0m14:41:06.539589 [debug] [Thread-3  ]: Began compiling node model.weather_dbt.final
[0m14:41:06.541827 [debug] [Thread-3  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m14:41:06.542368 [debug] [Thread-3  ]: Began executing node model.weather_dbt.final
[0m14:41:06.545172 [debug] [Thread-3  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m14:41:06.545937 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m14:41:06.546165 [debug] [Thread-3  ]: On model.weather_dbt.final: BEGIN
[0m14:41:06.546372 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m14:41:06.550875 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m14:41:06.551164 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m14:41:06.551387 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_weather_db"."staging"
GROUP BY location
  );
  
[0m14:41:06.606252 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.055 seconds
[0m14:41:06.608530 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m14:41:06.608768 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final" rename to "final__dbt_backup"
[0m14:41:06.609354 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:06.611123 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m14:41:06.611323 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final__dbt_tmp" rename to "final"
[0m14:41:06.611807 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:06.612793 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m14:41:06.613004 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m14:41:06.613189 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m14:41:06.644554 [debug] [Thread-3  ]: SQL status: COMMIT in 0.031 seconds
[0m14:41:06.646881 [debug] [Thread-3  ]: Applying DROP to: "weather_db"."public_weather_db"."final__dbt_backup"
[0m14:41:06.647304 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m14:41:06.647510 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
drop table if exists "weather_db"."public_weather_db"."final__dbt_backup" cascade
[0m14:41:06.649930 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.002 seconds
[0m14:41:06.650719 [debug] [Thread-3  ]: On model.weather_dbt.final: Close
[0m14:41:06.651063 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca6c2de-17a6-4b28-b513-c82c29069387', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107960a30>]}
[0m14:41:06.651433 [info ] [Thread-3  ]: 2 of 2 OK created sql table model public_weather_db.final ...................... [[32mSELECT 10[0m in 0.11s]
[0m14:41:06.651750 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m14:41:06.654683 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:06.655034 [debug] [MainThread]: On master: BEGIN
[0m14:41:06.655236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:06.665589 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:41:06.665909 [debug] [MainThread]: On master: COMMIT
[0m14:41:06.666120 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:06.666309 [debug] [MainThread]: On master: COMMIT
[0m14:41:06.666736 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:06.666984 [debug] [MainThread]: On master: Close
[0m14:41:06.667276 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:06.667467 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m14:41:06.667634 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m14:41:06.667908 [info ] [MainThread]: 
[0m14:41:06.668127 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m14:41:06.668688 [debug] [MainThread]: Command end result
[0m14:41:06.685496 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m14:41:06.686758 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m14:41:06.691379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m14:41:06.691676 [info ] [MainThread]: 
[0m14:41:06.691963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:06.692177 [info ] [MainThread]: 
[0m14:41:06.692404 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:41:06.694400 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5220977, "process_in_blocks": "0", "process_kernel_time": 0.204016, "process_mem_max_rss": "115867648", "process_out_blocks": "0", "process_user_time": 1.132125}
[0m14:41:06.694945 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:06.694874 after 1.52 seconds
[0m14:41:06.695245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e03880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074275e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074276a0>]}
[0m14:41:06.695533 [debug] [MainThread]: Flushing usage events
[0m14:41:09.152737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:21.699111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447340>]}


============================== 15:01:21.702060 | 33eb8956-416a-4af4-93d4-c162b66aa9a2 ==============================
[0m15:01:21.702060 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:01:21.702413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:01:21.838140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d4b50>]}
[0m15:01:21.866966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064185e0>]}
[0m15:01:21.867656 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:01:21.946137 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:01:21.985285 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:01:21.985608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb92e0>]}
[0m15:01:22.519401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c940d0>]}
[0m15:01:22.556497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m15:01:22.559337 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m15:01:22.568392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3fa60>]}
[0m15:01:22.568679 [info ] [MainThread]: Found 2 models, 433 macros
[0m15:01:22.568869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3c190>]}
[0m15:01:22.569624 [info ] [MainThread]: 
[0m15:01:22.569817 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:01:22.569972 [info ] [MainThread]: 
[0m15:01:22.570240 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:22.572613 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m15:01:22.598838 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m15:01:22.599111 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m15:01:22.599269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:22.750026 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.151 seconds
[0m15:01:22.751562 [debug] [ThreadPool]: On list_weather_db: Close
[0m15:01:22.752860 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now list_weather_db_public_weather_db)
[0m15:01:22.759245 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m15:01:22.759623 [debug] [ThreadPool]: On list_weather_db_public_weather_db: BEGIN
[0m15:01:22.759905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:22.766725 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:01:22.767166 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_weather_db"
[0m15:01:22.767503 [debug] [ThreadPool]: On list_weather_db_public_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_weather_db"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_weather_db'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_weather_db'
  
[0m15:01:22.773697 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.006 seconds
[0m15:01:22.775066 [debug] [ThreadPool]: On list_weather_db_public_weather_db: ROLLBACK
[0m15:01:22.775753 [debug] [ThreadPool]: On list_weather_db_public_weather_db: Close
[0m15:01:22.780704 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:22.781050 [debug] [MainThread]: On master: BEGIN
[0m15:01:22.781302 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:22.786868 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:01:22.787274 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:22.787694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:01:22.797833 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:01:22.799242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715b820>]}
[0m15:01:22.799726 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:22.800466 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:22.800793 [debug] [MainThread]: On master: BEGIN
[0m15:01:22.801690 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:01:22.802036 [debug] [MainThread]: On master: COMMIT
[0m15:01:22.802339 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:22.802622 [debug] [MainThread]: On master: COMMIT
[0m15:01:22.803264 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:22.803572 [debug] [MainThread]: On master: Close
[0m15:01:22.804860 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m15:01:22.805391 [info ] [Thread-1  ]: 1 of 2 START sql table model public_weather_db.staging ......................... [RUN]
[0m15:01:22.805843 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_weather_db, now model.weather_dbt.staging)
[0m15:01:22.806189 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m15:01:22.813181 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m15:01:22.813964 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m15:01:22.837529 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m15:01:22.838083 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:01:22.838280 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m15:01:22.838456 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:01:22.842117 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m15:01:22.842416 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:01:22.842625 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_weather_db"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data
  );
  
[0m15:01:23.325838 [debug] [Thread-1  ]: SQL status: SELECT 995879 in 0.483 seconds
[0m15:01:23.335956 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:01:23.336331 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging" rename to "staging__dbt_backup"
[0m15:01:23.337399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:23.339581 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:01:23.339835 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_weather_db"."staging__dbt_tmp" rename to "staging"
[0m15:01:23.340600 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:01:23.352029 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m15:01:23.352377 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:01:23.352581 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m15:01:23.364758 [debug] [Thread-1  ]: SQL status: COMMIT in 0.012 seconds
[0m15:01:23.368941 [debug] [Thread-1  ]: Applying DROP to: "weather_db"."public_weather_db"."staging__dbt_backup"
[0m15:01:23.371447 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:01:23.371688 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
drop table if exists "weather_db"."public_weather_db"."staging__dbt_backup" cascade
[0m15:01:23.379091 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.007 seconds
[0m15:01:23.380867 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m15:01:23.382227 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190430>]}
[0m15:01:23.382733 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_weather_db.staging .................... [[32mSELECT 995879[0m in 0.58s]
[0m15:01:23.383121 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m15:01:23.383803 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m15:01:23.384214 [info ] [Thread-3  ]: 2 of 2 START sql table model public_weather_db.final ........................... [RUN]
[0m15:01:23.384597 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.weather_dbt.final'
[0m15:01:23.384830 [debug] [Thread-3  ]: Began compiling node model.weather_dbt.final
[0m15:01:23.387446 [debug] [Thread-3  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m15:01:23.388199 [debug] [Thread-3  ]: Began executing node model.weather_dbt.final
[0m15:01:23.391884 [debug] [Thread-3  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m15:01:23.392598 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:01:23.392824 [debug] [Thread-3  ]: On model.weather_dbt.final: BEGIN
[0m15:01:23.393036 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:01:23.396898 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m15:01:23.397180 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:01:23.397431 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_weather_db"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_weather_db"."staging"
GROUP BY location
  );
  
[0m15:01:23.452154 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.054 seconds
[0m15:01:23.456549 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:01:23.456833 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final" rename to "final__dbt_backup"
[0m15:01:23.457451 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:23.459334 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:01:23.459553 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_weather_db"."final__dbt_tmp" rename to "final"
[0m15:01:23.460039 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:01:23.461003 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m15:01:23.461200 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:01:23.461377 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m15:01:23.507003 [debug] [Thread-3  ]: SQL status: COMMIT in 0.045 seconds
[0m15:01:23.511268 [debug] [Thread-3  ]: Applying DROP to: "weather_db"."public_weather_db"."final__dbt_backup"
[0m15:01:23.511877 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:01:23.512103 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
drop table if exists "weather_db"."public_weather_db"."final__dbt_backup" cascade
[0m15:01:23.513747 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.001 seconds
[0m15:01:23.514787 [debug] [Thread-3  ]: On model.weather_dbt.final: Close
[0m15:01:23.515223 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33eb8956-416a-4af4-93d4-c162b66aa9a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107190190>]}
[0m15:01:23.515678 [info ] [Thread-3  ]: 2 of 2 OK created sql table model public_weather_db.final ...................... [[32mSELECT 10[0m in 0.13s]
[0m15:01:23.516048 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m15:01:23.517053 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:23.517325 [debug] [MainThread]: On master: BEGIN
[0m15:01:23.517512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:23.522304 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:01:23.522629 [debug] [MainThread]: On master: COMMIT
[0m15:01:23.522822 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:23.522998 [debug] [MainThread]: On master: COMMIT
[0m15:01:23.523499 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:23.523724 [debug] [MainThread]: On master: Close
[0m15:01:23.524007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:23.524171 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m15:01:23.524320 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m15:01:23.524546 [info ] [MainThread]: 
[0m15:01:23.524741 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:01:23.525230 [debug] [MainThread]: Command end result
[0m15:01:23.577613 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m15:01:23.578687 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m15:01:23.583083 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m15:01:23.583322 [info ] [MainThread]: 
[0m15:01:23.583586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:23.583780 [info ] [MainThread]: 
[0m15:01:23.583985 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:01:23.585290 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9284774, "process_in_blocks": "0", "process_kernel_time": 0.229626, "process_mem_max_rss": "118177792", "process_out_blocks": "0", "process_user_time": 1.648557}
[0m15:01:23.585721 [debug] [MainThread]: Command `dbt run` succeeded at 15:01:23.585660 after 1.93 seconds
[0m15:01:23.585978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105138100>]}
[0m15:01:23.586235 [debug] [MainThread]: Flushing usage events
[0m15:01:24.868843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:30.200610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075eb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847cac0>]}


============================== 15:02:30.205122 | 5a7f7ad8-92d2-4e2f-b578-35c71952fb20 ==============================
[0m15:02:30.205122 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:02:30.205508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:30.340304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108801220>]}
[0m15:02:30.368607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844c100>]}
[0m15:02:30.369275 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:02:30.448041 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:02:30.487306 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:02:30.487624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee5df0>]}
[0m15:02:31.021186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc80d0>]}
[0m15:02:31.059106 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m15:02:31.062408 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m15:02:31.072756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d73790>]}
[0m15:02:31.073094 [info ] [MainThread]: Found 2 models, 433 macros
[0m15:02:31.073287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d701c0>]}
[0m15:02:31.074083 [info ] [MainThread]: 
[0m15:02:31.074286 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:31.074444 [info ] [MainThread]: 
[0m15:02:31.074725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:02:31.077255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m15:02:31.105339 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m15:02:31.105615 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m15:02:31.105782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:31.209409 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.104 seconds
[0m15:02:31.210270 [debug] [ThreadPool]: On list_weather_db: Close
[0m15:02:31.210688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_weather_db, now create_weather_db_public_public)
[0m15:02:31.211154 [debug] [ThreadPool]: Creating schema "database: "weather_db"
schema: "public_public"
"
[0m15:02:31.214522 [debug] [ThreadPool]: Using postgres connection "create_weather_db_public_public"
[0m15:02:31.214751 [debug] [ThreadPool]: On create_weather_db_public_public: BEGIN
[0m15:02:31.214914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:31.221739 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:02:31.222071 [debug] [ThreadPool]: Using postgres connection "create_weather_db_public_public"
[0m15:02:31.222250 [debug] [ThreadPool]: On create_weather_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "create_weather_db_public_public"} */
create schema if not exists "public_public"
[0m15:02:31.222976 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m15:02:31.223531 [debug] [ThreadPool]: On create_weather_db_public_public: COMMIT
[0m15:02:31.223710 [debug] [ThreadPool]: Using postgres connection "create_weather_db_public_public"
[0m15:02:31.223860 [debug] [ThreadPool]: On create_weather_db_public_public: COMMIT
[0m15:02:31.224837 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m15:02:31.225063 [debug] [ThreadPool]: On create_weather_db_public_public: Close
[0m15:02:31.225792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_weather_db_public_public, now list_weather_db_public_public)
[0m15:02:31.229501 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_public"
[0m15:02:31.229760 [debug] [ThreadPool]: On list_weather_db_public_public: BEGIN
[0m15:02:31.229918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:31.233538 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:02:31.233874 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public_public"
[0m15:02:31.234065 [debug] [ThreadPool]: On list_weather_db_public_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public_public"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m15:02:31.236910 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:02:31.237703 [debug] [ThreadPool]: On list_weather_db_public_public: ROLLBACK
[0m15:02:31.238097 [debug] [ThreadPool]: On list_weather_db_public_public: Close
[0m15:02:31.240973 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:31.241230 [debug] [MainThread]: On master: BEGIN
[0m15:02:31.241385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:31.245594 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:02:31.245939 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:31.246195 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:02:31.251431 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m15:02:31.252345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091312b0>]}
[0m15:02:31.252695 [debug] [MainThread]: On master: ROLLBACK
[0m15:02:31.253357 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:31.253546 [debug] [MainThread]: On master: BEGIN
[0m15:02:31.254346 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:02:31.254545 [debug] [MainThread]: On master: COMMIT
[0m15:02:31.254713 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:31.254867 [debug] [MainThread]: On master: COMMIT
[0m15:02:31.255327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:02:31.255556 [debug] [MainThread]: On master: Close
[0m15:02:31.256682 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m15:02:31.257097 [info ] [Thread-1  ]: 1 of 2 START sql table model public_public.staging ............................. [RUN]
[0m15:02:31.257422 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db_public_public, now model.weather_dbt.staging)
[0m15:02:31.257638 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m15:02:31.262546 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m15:02:31.263542 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m15:02:31.286036 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m15:02:31.286629 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:02:31.286831 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m15:02:31.287011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:02:31.290963 [debug] [Thread-1  ]: SQL status: BEGIN in 0.004 seconds
[0m15:02:31.291284 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:02:31.291491 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public_public"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data
  );
  
[0m15:02:31.854442 [debug] [Thread-1  ]: SQL status: SELECT 995879 in 0.562 seconds
[0m15:02:31.863999 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:02:31.864351 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public_public"."staging__dbt_tmp" rename to "staging"
[0m15:02:31.865244 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:02:31.875406 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m15:02:31.875721 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:02:31.875917 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m15:02:31.893214 [debug] [Thread-1  ]: SQL status: COMMIT in 0.017 seconds
[0m15:02:31.897109 [debug] [Thread-1  ]: Applying DROP to: "weather_db"."public_public"."staging__dbt_backup"
[0m15:02:31.899557 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:02:31.899804 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
drop table if exists "weather_db"."public_public"."staging__dbt_backup" cascade
[0m15:02:31.900534 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m15:02:31.902195 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m15:02:31.903911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a8bb0>]}
[0m15:02:31.904445 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public_public.staging ........................ [[32mSELECT 995879[0m in 0.65s]
[0m15:02:31.904962 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m15:02:31.905927 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m15:02:31.906676 [info ] [Thread-3  ]: 2 of 2 START sql table model public_public.final ............................... [RUN]
[0m15:02:31.907361 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.weather_dbt.final'
[0m15:02:31.908003 [debug] [Thread-3  ]: Began compiling node model.weather_dbt.final
[0m15:02:31.910723 [debug] [Thread-3  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m15:02:31.911749 [debug] [Thread-3  ]: Began executing node model.weather_dbt.final
[0m15:02:31.915309 [debug] [Thread-3  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m15:02:31.916101 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:02:31.916345 [debug] [Thread-3  ]: On model.weather_dbt.final: BEGIN
[0m15:02:31.916545 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:02:31.922498 [debug] [Thread-3  ]: SQL status: BEGIN in 0.006 seconds
[0m15:02:31.922850 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:02:31.923065 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public_public"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public_public"."staging"
GROUP BY location
  );
  
[0m15:02:31.980754 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.057 seconds
[0m15:02:31.982944 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:02:31.983158 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public_public"."final__dbt_tmp" rename to "final"
[0m15:02:31.983752 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:02:31.984587 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m15:02:31.984778 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:02:31.984946 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m15:02:31.985760 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m15:02:31.987347 [debug] [Thread-3  ]: Applying DROP to: "weather_db"."public_public"."final__dbt_backup"
[0m15:02:31.987762 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:02:31.987960 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
drop table if exists "weather_db"."public_public"."final__dbt_backup" cascade
[0m15:02:31.988437 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.000 seconds
[0m15:02:31.989140 [debug] [Thread-3  ]: On model.weather_dbt.final: Close
[0m15:02:31.989478 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a7f7ad8-92d2-4e2f-b578-35c71952fb20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091312e0>]}
[0m15:02:31.989856 [info ] [Thread-3  ]: 2 of 2 OK created sql table model public_public.final .......................... [[32mSELECT 10[0m in 0.08s]
[0m15:02:31.990172 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m15:02:31.990999 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:31.991212 [debug] [MainThread]: On master: BEGIN
[0m15:02:31.991371 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:31.995904 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:02:31.996221 [debug] [MainThread]: On master: COMMIT
[0m15:02:31.996403 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:31.996559 [debug] [MainThread]: On master: COMMIT
[0m15:02:31.996998 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:02:31.997220 [debug] [MainThread]: On master: Close
[0m15:02:31.997482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:31.997651 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m15:02:31.997800 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m15:02:31.998006 [info ] [MainThread]: 
[0m15:02:31.998193 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m15:02:31.998671 [debug] [MainThread]: Command end result
[0m15:02:32.043571 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m15:02:32.044561 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m15:02:32.048145 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m15:02:32.048371 [info ] [MainThread]: 
[0m15:02:32.048608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:32.048829 [info ] [MainThread]: 
[0m15:02:32.049088 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:02:32.050755 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8886213, "process_in_blocks": "0", "process_kernel_time": 0.202929, "process_mem_max_rss": "120684544", "process_out_blocks": "0", "process_user_time": 1.576331}
[0m15:02:32.051175 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:32.051125 after 1.89 seconds
[0m15:02:32.051414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075eb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d70c10>]}
[0m15:02:32.051647 [debug] [MainThread]: Flushing usage events
[0m15:02:34.296801 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:06.319754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10342e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b93a0>]}


============================== 15:03:06.322530 | 32072a6f-b4cf-40de-b2cd-c81b17eef335 ==============================
[0m15:03:06.322530 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:03:06.322872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m15:03:06.330668 [info ] [MainThread]: dbt version: 1.9.2
[0m15:03:06.330939 [info ] [MainThread]: python version: 3.9.21
[0m15:03:06.331106 [info ] [MainThread]: python path: /opt/homebrew/opt/python@3.9/bin/python3.9
[0m15:03:06.331266 [info ] [MainThread]: os info: macOS-13.0.1-arm64-arm-64bit
[0m15:03:06.365180 [info ] [MainThread]: Using profiles dir at /Users/tim301248/Desktop/Data Engineer/weather/dbt
[0m15:03:06.365535 [info ] [MainThread]: Using profiles.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/profiles.yml
[0m15:03:06.365720 [info ] [MainThread]: Using dbt_project.yml file at /Users/tim301248/Desktop/Data Engineer/weather/dbt/dbt_project.yml
[0m15:03:06.366121 [info ] [MainThread]: adapter type: postgres
[0m15:03:06.366353 [info ] [MainThread]: adapter version: 1.9.0
[0m15:03:06.434146 [info ] [MainThread]: Configuration:
[0m15:03:06.434486 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:03:06.434671 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:03:06.434832 [info ] [MainThread]: Required dependencies:
[0m15:03:06.435098 [debug] [MainThread]: Executing "git --help"
[0m15:03:06.461777 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:03:06.462360 [debug] [MainThread]: STDERR: "b''"
[0m15:03:06.462580 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:03:06.462790 [info ] [MainThread]: Connection:
[0m15:03:06.463029 [info ] [MainThread]:   host: localhost
[0m15:03:06.463184 [info ] [MainThread]:   port: 5432
[0m15:03:06.463330 [info ] [MainThread]:   user: airflow
[0m15:03:06.463476 [info ] [MainThread]:   database: weather_db
[0m15:03:06.463619 [info ] [MainThread]:   schema: public
[0m15:03:06.463761 [info ] [MainThread]:   connect_timeout: 10
[0m15:03:06.463907 [info ] [MainThread]:   role: None
[0m15:03:06.464049 [info ] [MainThread]:   search_path: None
[0m15:03:06.464190 [info ] [MainThread]:   keepalives_idle: 0
[0m15:03:06.464329 [info ] [MainThread]:   sslmode: None
[0m15:03:06.464472 [info ] [MainThread]:   sslcert: None
[0m15:03:06.464613 [info ] [MainThread]:   sslkey: None
[0m15:03:06.464755 [info ] [MainThread]:   sslrootcert: None
[0m15:03:06.464893 [info ] [MainThread]:   application_name: dbt
[0m15:03:06.465036 [info ] [MainThread]:   retries: 1
[0m15:03:06.465422 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:03:06.537542 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:03:06.557694 [debug] [MainThread]: Using postgres connection "debug"
[0m15:03:06.557952 [debug] [MainThread]: On debug: select 1 as id
[0m15:03:06.558110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:03:06.662866 [debug] [MainThread]: SQL status: SELECT 1 in 0.105 seconds
[0m15:03:06.663938 [debug] [MainThread]: On debug: Close
[0m15:03:06.664299 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:03:06.664627 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:03:06.666481 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.38464028, "process_in_blocks": "0", "process_kernel_time": 0.165961, "process_mem_max_rss": "109854720", "process_out_blocks": "0", "process_user_time": 0.805073}
[0m15:03:06.667210 [debug] [MainThread]: Command `dbt debug` succeeded at 15:03:06.667097 after 0.39 seconds
[0m15:03:06.667560 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:03:06.667915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10342e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104580460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10472a040>]}
[0m15:03:06.668317 [debug] [MainThread]: Flushing usage events
[0m15:03:09.088369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:14.398341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107626880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b99d0>]}


============================== 15:13:14.401975 | 02ac158f-047e-4c89-a3ff-6493cdea32f6 ==============================
[0m15:13:14.401975 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:13:14.402343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/tim301248/Desktop/Data Engineer/weather/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/tim301248/Desktop/Data Engineer/weather/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'send_anonymous_usage_stats': 'True'}
[0m15:13:14.532213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068257f0>]}
[0m15:13:14.560342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872c6a0>]}
[0m15:13:14.561007 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:13:14.638791 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:13:14.678511 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m15:13:14.678823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f29e80>]}
[0m15:13:15.209672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d4a130>]}
[0m15:13:15.245123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m15:13:15.248194 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m15:13:15.257758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dae7f0>]}
[0m15:13:15.258038 [info ] [MainThread]: Found 2 models, 433 macros
[0m15:13:15.258220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108daa190>]}
[0m15:13:15.258997 [info ] [MainThread]: 
[0m15:13:15.259189 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:13:15.259351 [info ] [MainThread]: 
[0m15:13:15.259617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:13:15.261843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db'
[0m15:13:15.287874 [debug] [ThreadPool]: Using postgres connection "list_weather_db"
[0m15:13:15.288128 [debug] [ThreadPool]: On list_weather_db: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db"} */

    select distinct nspname from pg_namespace
  
[0m15:13:15.288286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:15.398513 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.110 seconds
[0m15:13:15.399858 [debug] [ThreadPool]: On list_weather_db: Close
[0m15:13:15.401037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_weather_db_public'
[0m15:13:15.407278 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public"
[0m15:13:15.407638 [debug] [ThreadPool]: On list_weather_db_public: BEGIN
[0m15:13:15.407913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:15.413171 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:13:15.413537 [debug] [ThreadPool]: Using postgres connection "list_weather_db_public"
[0m15:13:15.413857 [debug] [ThreadPool]: On list_weather_db_public: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "list_weather_db_public"} */
select
      'weather_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'weather_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'weather_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:13:15.417852 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:13:15.419079 [debug] [ThreadPool]: On list_weather_db_public: ROLLBACK
[0m15:13:15.419703 [debug] [ThreadPool]: On list_weather_db_public: Close
[0m15:13:15.424387 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:15.424786 [debug] [MainThread]: On master: BEGIN
[0m15:13:15.425076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:15.429724 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m15:13:15.430060 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:15.430432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:13:15.440982 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m15:13:15.442256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ce8b0>]}
[0m15:13:15.442700 [debug] [MainThread]: On master: ROLLBACK
[0m15:13:15.443417 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:15.443784 [debug] [MainThread]: On master: BEGIN
[0m15:13:15.444824 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:13:15.445174 [debug] [MainThread]: On master: COMMIT
[0m15:13:15.445469 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:15.445737 [debug] [MainThread]: On master: COMMIT
[0m15:13:15.446342 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:15.446629 [debug] [MainThread]: On master: Close
[0m15:13:15.447918 [debug] [Thread-1  ]: Began running node model.weather_dbt.staging
[0m15:13:15.448450 [info ] [Thread-1  ]: 1 of 2 START sql table model public.staging .................................... [RUN]
[0m15:13:15.448899 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_weather_db, now model.weather_dbt.staging)
[0m15:13:15.449203 [debug] [Thread-1  ]: Began compiling node model.weather_dbt.staging
[0m15:13:15.456272 [debug] [Thread-1  ]: Writing injected SQL for node "model.weather_dbt.staging"
[0m15:13:15.457088 [debug] [Thread-1  ]: Began executing node model.weather_dbt.staging
[0m15:13:15.484836 [debug] [Thread-1  ]: Writing runtime sql for node "model.weather_dbt.staging"
[0m15:13:15.485723 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:13:15.485968 [debug] [Thread-1  ]: On model.weather_dbt.staging: BEGIN
[0m15:13:15.486175 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:13:15.491150 [debug] [Thread-1  ]: SQL status: BEGIN in 0.005 seconds
[0m15:13:15.491435 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:13:15.491659 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */

  
    

  create  table "weather_db"."public"."staging__dbt_tmp"
  
  
    as
  
  (
    SELECT date, location, avg_temp 
FROM weather_data
  );
  
[0m15:13:16.048998 [debug] [Thread-1  ]: SQL status: SELECT 995879 in 0.557 seconds
[0m15:13:16.063170 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:13:16.063968 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
alter table "weather_db"."public"."staging__dbt_tmp" rename to "staging"
[0m15:13:16.065028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:16.083194 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m15:13:16.083665 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:13:16.084051 [debug] [Thread-1  ]: On model.weather_dbt.staging: COMMIT
[0m15:13:16.102383 [debug] [Thread-1  ]: SQL status: COMMIT in 0.018 seconds
[0m15:13:16.106878 [debug] [Thread-1  ]: Applying DROP to: "weather_db"."public"."staging__dbt_backup"
[0m15:13:16.111791 [debug] [Thread-1  ]: Using postgres connection "model.weather_dbt.staging"
[0m15:13:16.112068 [debug] [Thread-1  ]: On model.weather_dbt.staging: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.staging"} */
drop table if exists "weather_db"."public"."staging__dbt_backup" cascade
[0m15:13:16.112775 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.000 seconds
[0m15:13:16.114494 [debug] [Thread-1  ]: On model.weather_dbt.staging: Close
[0m15:13:16.115892 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109200340>]}
[0m15:13:16.116368 [info ] [Thread-1  ]: 1 of 2 OK created sql table model public.staging ............................... [[32mSELECT 995879[0m in 0.67s]
[0m15:13:16.116766 [debug] [Thread-1  ]: Finished running node model.weather_dbt.staging
[0m15:13:16.117276 [debug] [Thread-3  ]: Began running node model.weather_dbt.final
[0m15:13:16.117660 [info ] [Thread-3  ]: 2 of 2 START sql table model public.final ...................................... [RUN]
[0m15:13:16.118010 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.weather_dbt.final'
[0m15:13:16.118238 [debug] [Thread-3  ]: Began compiling node model.weather_dbt.final
[0m15:13:16.120496 [debug] [Thread-3  ]: Writing injected SQL for node "model.weather_dbt.final"
[0m15:13:16.121346 [debug] [Thread-3  ]: Began executing node model.weather_dbt.final
[0m15:13:16.124531 [debug] [Thread-3  ]: Writing runtime sql for node "model.weather_dbt.final"
[0m15:13:16.125263 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:13:16.125519 [debug] [Thread-3  ]: On model.weather_dbt.final: BEGIN
[0m15:13:16.125753 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m15:13:16.129925 [debug] [Thread-3  ]: SQL status: BEGIN in 0.004 seconds
[0m15:13:16.130256 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:13:16.130518 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */

  
    

  create  table "weather_db"."public"."final__dbt_tmp"
  
  
    as
  
  (
    SELECT 
    location, 
    AVG(avg_temp) AS monthly_avg_temp 
FROM "weather_db"."public"."staging"
GROUP BY location
  );
  
[0m15:13:16.188462 [debug] [Thread-3  ]: SQL status: SELECT 10 in 0.058 seconds
[0m15:13:16.191227 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:13:16.191457 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
alter table "weather_db"."public"."final__dbt_tmp" rename to "final"
[0m15:13:16.192074 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:16.192914 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m15:13:16.193111 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:13:16.193287 [debug] [Thread-3  ]: On model.weather_dbt.final: COMMIT
[0m15:13:16.194277 [debug] [Thread-3  ]: SQL status: COMMIT in 0.001 seconds
[0m15:13:16.195778 [debug] [Thread-3  ]: Applying DROP to: "weather_db"."public"."final__dbt_backup"
[0m15:13:16.196190 [debug] [Thread-3  ]: Using postgres connection "model.weather_dbt.final"
[0m15:13:16.196395 [debug] [Thread-3  ]: On model.weather_dbt.final: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "default", "target_name": "dev", "node_id": "model.weather_dbt.final"} */
drop table if exists "weather_db"."public"."final__dbt_backup" cascade
[0m15:13:16.196899 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.000 seconds
[0m15:13:16.197633 [debug] [Thread-3  ]: On model.weather_dbt.final: Close
[0m15:13:16.197983 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ac158f-047e-4c89-a3ff-6493cdea32f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109200340>]}
[0m15:13:16.198376 [info ] [Thread-3  ]: 2 of 2 OK created sql table model public.final ................................. [[32mSELECT 10[0m in 0.08s]
[0m15:13:16.198713 [debug] [Thread-3  ]: Finished running node model.weather_dbt.final
[0m15:13:16.199446 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:16.199682 [debug] [MainThread]: On master: BEGIN
[0m15:13:16.199857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:13:16.204078 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:13:16.204528 [debug] [MainThread]: On master: COMMIT
[0m15:13:16.204733 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:16.204905 [debug] [MainThread]: On master: COMMIT
[0m15:13:16.205266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:16.205470 [debug] [MainThread]: On master: Close
[0m15:13:16.205742 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:16.205910 [debug] [MainThread]: Connection 'model.weather_dbt.staging' was properly closed.
[0m15:13:16.206062 [debug] [MainThread]: Connection 'list_weather_db_public' was properly closed.
[0m15:13:16.206208 [debug] [MainThread]: Connection 'model.weather_dbt.final' was properly closed.
[0m15:13:16.206432 [info ] [MainThread]: 
[0m15:13:16.206625 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m15:13:16.207123 [debug] [MainThread]: Command end result
[0m15:13:16.223231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/manifest.json
[0m15:13:16.224521 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/semantic_manifest.json
[0m15:13:16.229019 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/tim301248/Desktop/Data Engineer/weather/dbt/target/run_results.json
[0m15:13:16.229259 [info ] [MainThread]: 
[0m15:13:16.229525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:13:16.229733 [info ] [MainThread]: 
[0m15:13:16.229950 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:13:16.231292 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8728004, "process_in_blocks": "0", "process_kernel_time": 0.200188, "process_mem_max_rss": "120061952", "process_out_blocks": "0", "process_user_time": 1.586338}
[0m15:13:16.231706 [debug] [MainThread]: Command `dbt run` succeeded at 15:13:16.231649 after 1.87 seconds
[0m15:13:16.231973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107626880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a4fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10872c6a0>]}
[0m15:13:16.232235 [debug] [MainThread]: Flushing usage events
[0m15:13:18.470563 [debug] [MainThread]: An error was encountered while trying to flush usage events
